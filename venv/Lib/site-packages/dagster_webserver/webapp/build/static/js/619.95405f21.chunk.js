"use strict";(self.webpackChunk_dagster_io_dagit_app=self.webpackChunk_dagster_io_dagit_app||[]).push([[619],{15682:function(e,n,t){t.d(n,{C:function(){return h}});var r=t(96234),s=t(3077),i=t(47515),o=t(45519),a=t(61623),l=t(78193),c=t(18791),d=t(92761),u=t(35936),h=function(){var e=l.useContext(d.C5),n=e.allRepos,t=e.visibleRepos,h=e.toggleVisible,f=l.useState(!1),p=(0,r.Z)(f,2),x=p[0],g=p[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(s.Vq,{canOutsideClickClose:!0,canEscapeKeyClose:!0,isOpen:x,style:{width:"auto"},onClose:function(){return g(!1)},children:[(0,u.jsx)(s.fK,{icon:"repo",label:"Filter code locations"}),(0,u.jsx)(c.e,{options:n,onBrowse:function(){return g(!1)},onToggle:h,selected:t}),(0,u.jsx)(s.cN,{children:(0,u.jsx)(i.x,{padding:{top:8},children:(0,u.jsx)(o.zx,{intent:"none",onClick:function(){return g(!1)},children:"Done"})})})]}),(0,u.jsx)(o.zx,{intent:"none",icon:(0,u.jsx)(a.JO,{name:"folder"}),rightIcon:(0,u.jsx)(a.JO,{name:"expand_more"}),onClick:function(){return g(!0)},children:"".concat(t.length," of ").concat(n.length)})]})}},4166:function(e,n,t){t.r(n),t.d(n,{OverviewRoot:function(){return _t},default:function(){return Ft}});var r,s,i,o=t(78193),a=t(50032),l=t(71171),c=t(33028),d=t(90239),u=t(31623),h=t(3586),f=t(20356),p=t(83473),x=t(47515),g=t(67445),m=t(86562),v=t(62638),j=t(92014),y=t(39707),w=t(74894),b=t(67099),k=t(16185),S=t(4248),C=t(35936),A=function(e){var n=e.refreshState,t=e.tab;return(0,C.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,C.jsxs)(k.mQ,{selectedTabId:t,children:[(0,C.jsx)(S.f,{id:"activity",title:"Activity",to:"/overview/activity"}),(0,C.jsx)(S.f,{id:"jobs",title:"Jobs",to:"/overview/jobs"}),(0,C.jsx)(S.f,{id:"schedules",title:"Schedules",to:"/overview/schedules"}),(0,C.jsx)(S.f,{id:"sensors",title:"Sensors",to:"/overview/sensors"}),(0,C.jsx)(S.f,{id:"resources",title:"Resources",to:"/overview/resources"}),(0,C.jsx)(S.f,{id:"backfills",title:"Backfills",to:"/overview/backfills"})]}),n?(0,C.jsx)(x.x,{padding:{bottom:8},children:(0,C.jsx)(y.xi,{refreshState:n})}):null]})},E=t(13079),T=t(4774),N=t(13422),I=t(97021),O=t(3245),R=function(){(0,w.Px)(),(0,b.j)("Overview | Backfills");var e=(0,d.a)(L),n=(0,T.l)({query:P,variables:{},pageSize:10,nextCursorForResult:function(e){var n;return"PartitionBackfills"===e.partitionBackfillsOrError.__typename?null===(n=e.partitionBackfillsOrError.results[9])||void 0===n?void 0:n.id:void 0},getResultArray:function(e){return"PartitionBackfills"===(null===e||void 0===e?void 0:e.partitionBackfillsOrError.__typename)?e.partitionBackfillsOrError.results:[]}}),t=n.queryResult,r=n.paginationProps,s=(0,y.C4)(t,y.dT);return(0,C.jsxs)(h.T,{children:[(0,C.jsx)(f.m,{title:(0,C.jsx)(p.X6,{children:"Overview"}),tabs:(0,C.jsx)(A,{tab:"backfills",refreshState:s})}),(0,C.jsx)(N.g,{queryResult:t,allowStaleData:!0,children:function(n){var s,i=n.partitionBackfillsOrError;if("PythonError"===i.__typename)return(0,C.jsx)(j.T9,{error:i});if(!i.results.length)return(0,C.jsx)(x.x,{padding:{vertical:64},children:(0,C.jsx)(g.t,{icon:"no-results",title:"No backfills found",description:(0,C.jsx)("p",{children:"This instance does not have any backfill jobs."})})});var o=((null===(s=e.data)||void 0===s?void 0:s.instance.daemonHealth.allDaemonStatuses)||[]).filter((function(e){return"BACKFILL"===e.daemonType})).map((function(e){return e.required&&e.healthy})),a=o.length&&o.every((function(e){return e}));return(0,C.jsxs)("div",{children:[a?null:(0,C.jsx)(x.x,{padding:{horizontal:24,vertical:16},children:(0,C.jsx)(E.B1,{})}),(0,C.jsx)(I.G,{backfills:i.results.slice(0,10),refetch:t.refetch}),i.results.length>0?(0,C.jsx)("div",{style:{marginTop:"16px"},children:(0,C.jsx)(m.b$,(0,c.Z)({},r))}):null]})}})]})},L=(0,u.Ps)(r||(r=(0,l.Z)(["\n  query InstanceHealthForBackfillsQuery {\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n"])),O.O),P=(0,u.Ps)(s||(s=(0,l.Z)(["\n  query InstanceBackfillsQuery($cursor: String, $limit: Int) {\n    partitionBackfillsOrError(cursor: $cursor, limit: $limit) {\n      ... on PartitionBackfills {\n        results {\n          id\n          status\n          isValidSerialization\n          numPartitions\n          timestamp\n          partitionSetName\n          partitionSet {\n            id\n            name\n            mode\n            pipelineName\n            repositoryOrigin {\n              id\n              repositoryName\n              repositoryLocationName\n            }\n          }\n          error {\n            ...PythonErrorFragment\n          }\n\n          ...BackfillTableFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),v.B,I.b),_=t(96234),F=t(60319),Z=t(62459),z=t(67888),B=t(95714),U=t(32667),M=t(92555),D=t(3077),V=t(45519),q=t(787),K=t.n(q),G=t(38343),$=t.n(G),W=t(67274),Q=t.n(W),J=t(97412),H=t(80005),Y=t(40854),X=t(20822),ee=t(85514),ne=t(23555),te=t(78612),re=t(95904),se=t(18517),ie=t(25960);K().extend($()),K().extend(Q());var oe=function(){var e=(0,a.UO)().backfillId;(0,w.Px)(),(0,b.j)("Backfill | ".concat(e));var n=(0,d.a)(he,{variables:{backfillId:e}}),t=n.data,r=null===t||void 0===t?void 0:t.partitionBackfillOrError,s=!0;r&&"PartitionBackfill"===r.__typename&&(s=[ne.Jv3.REQUESTED,ne.Jv3.CANCELING].includes(r.status));var i=(0,y.C4)(n,1e4,s);return(0,C.jsxs)(h.T,{children:[(0,C.jsx)(f.m,{title:(0,C.jsxs)("div",{style:{fontSize:"18px"},children:[(0,C.jsx)(J.rU,{to:"/overview/backfills",style:{color:U.w.Gray700},children:"Backfills"})," / ",e]}),right:s?(0,C.jsx)(y.xi,{refreshState:i}):null}),function(){var n,s,i;if(!r||!t)return(0,C.jsx)(x.x,{padding:64,"data-testid":(0,se.N)("page-loading-indicator"),children:(0,C.jsx)(Z.$,{purpose:"page"})});if("PythonError"===r.__typename)return(0,C.jsx)(j.T9,{error:r});if("BackfillNotFoundError"===r.__typename)return(0,C.jsx)(g.t,{icon:"no-results",title:r.message});function o(n){var t=[{token:"tag",value:"dagster/backfill=".concat(e)}];switch(n){case"inProgress":t.push({token:"status",value:ne.VOA.STARTED},{token:"status",value:ne.VOA.QUEUED},{token:"status",value:ne.VOA.STARTING},{token:"status",value:ne.VOA.CANCELING},{token:"status",value:ne.VOA.NOT_STARTED});break;case"complete":t.push({token:"status",value:ne.VOA.SUCCESS});break;case"failed":t.push({token:"status",value:ne.VOA.FAILURE}),t.push({token:"status",value:ne.VOA.CANCELED})}return(0,re.it)(t)}return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(x.x,{padding:24,flex:{direction:"row",justifyContent:"space-between",wrap:"nowrap",alignItems:"center"},"data-testid":(0,se.N)("backfill-page-details"),children:[(0,C.jsx)(ae,{label:"Created",detail:(0,C.jsx)(Y.E,{timestamp:{ms:Number(1e3*r.timestamp)},timeFormat:{showSeconds:!0,showTimezone:!1}})}),(0,C.jsx)(ae,{label:"Duration",detail:(0,C.jsx)(ue,{start:1e3*r.timestamp,end:r.endTimestamp?1e3*r.endTimestamp:null})}),(0,C.jsx)(ae,{label:"Partition Selection",detail:(0,C.jsx)(fe,{numPartitions:r.numPartitions||0,rootAssetTargetedPartitions:null===(n=r.assetBackfillData)||void 0===n?void 0:n.rootAssetTargetedPartitions,rootAssetTargetedRanges:null===(s=r.assetBackfillData)||void 0===s?void 0:s.rootAssetTargetedRanges})}),(0,C.jsx)(ae,{label:"Status",detail:(0,C.jsx)(le,{backfill:r})})]}),(0,C.jsxs)(z.i,{children:[(0,C.jsx)("thead",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{style:{width:"50%"},children:"Asset name"}),(0,C.jsx)("th",{children:(0,C.jsx)(J.rU,{to:o("targeted"),children:"Partitions targeted"})}),(0,C.jsx)("th",{children:(0,C.jsx)(J.rU,{to:o("inProgress"),children:"In progress"})}),(0,C.jsx)("th",{children:(0,C.jsx)(J.rU,{to:o("complete"),children:"Completed"})}),(0,C.jsx)("th",{children:(0,C.jsx)(J.rU,{to:o("failed"),children:"Failed"})})]})}),(0,C.jsx)("tbody",{children:null===(i=r.assetBackfillData)||void 0===i?void 0:i.assetBackfillStatuses.map((function(e){var n,t,r,s;return"AssetPartitionsStatusCounts"===e.__typename?(n=e.numPartitionsTargeted,t=e.numPartitionsInProgress,r=e.numPartitionsMaterialized,s=e.numPartitionsFailed):(n=1,s=e.failed?1:0,t=e.inProgress?1:0,r=e.materialized?1:0),(0,C.jsxs)("tr",{"data-testid":(0,se.N)("backfill-asset-row-".concat((0,X.Je)(e.assetKey))),children:[(0,C.jsx)("td",{children:(0,C.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between"},children:[(0,C.jsx)("div",{children:(0,C.jsx)(J.rU,{to:(0,ee.p)(e.assetKey),children:e.assetKey.path.join("/")})}),(0,C.jsx)("div",{children:(0,C.jsx)(ce,{targeted:n,inProgress:t,completed:r,failed:s})})]})}),"AssetPartitionsStatusCounts"===e.__typename?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("td",{children:n}),(0,C.jsx)("td",{children:t}),(0,C.jsx)("td",{children:r}),(0,C.jsx)("td",{children:s})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("td",{children:"-"}),(0,C.jsx)("td",{children:t?(0,C.jsx)(B.V,{icon:"spinner",intent:"primary",children:"In progress"}):"-"}),(0,C.jsx)("td",{children:r?(0,C.jsx)(B.V,{intent:"success",children:"Completed"}):"-"}),(0,C.jsx)("td",{children:s?(0,C.jsx)(B.V,{intent:"danger",children:"Failed"}):"-"})]})]},(0,X.Je)(e.assetKey))}))})]})]})}()]})},ae=function(e){var n=e.label,t=e.detail;return(0,C.jsxs)(x.x,{flex:{direction:"column",gap:4},style:{minWidth:"280px"},children:[(0,C.jsx)(de,{children:n}),(0,C.jsx)("div",{children:t})]})},le=function(e){var n=e.backfill;function t(e){return(0,C.jsx)(x.x,{margin:{bottom:12},children:(0,C.jsx)(xe,{onClick:function(){return n.error&&(0,H._)({title:"Error",body:(0,C.jsx)(j.T9,{error:n.error})})},children:(0,C.jsx)(B.V,{intent:"danger",children:e})})})}switch(n.status){case ne.Jv3.REQUESTED:return(0,C.jsx)(B.V,{children:"In Progress"});case ne.Jv3.CANCELING:return t("Canceling");case ne.Jv3.CANCELED:return t("Canceled");case ne.Jv3.FAILED:return t("Failed");case ne.Jv3.COMPLETED:return(0,C.jsx)(B.V,{intent:"success",children:"Completed"});default:return(0,C.jsx)(B.V,{children:n.status})}};function ce(e){var n=e.targeted,t=e.inProgress,r=e.completed,s=e.failed;return(0,C.jsxs)("div",{style:{borderRadius:"8px",backgroundColor:U.w.Gray100,display:"grid",gridTemplateColumns:"".concat(100*r/n,"% ").concat(100*s/n,"% ").concat(100*t/n,"%"),gridTemplateRows:"100%",height:"12px",width:"200px",overflow:"hidden"},children:[(0,C.jsx)("div",{style:{background:U.w.Green500}}),(0,C.jsx)("div",{style:{background:U.w.Red500}}),(0,C.jsx)("div",{style:{background:U.w.Blue200}})]})}var de=F.ZP.div.withConfig({displayName:"BackfillPage__Label",componentId:"sc-19sdlda-0"})(["color:",";font-size:12px;line-height:16px;"],U.w.Gray700),ue=function(e){var n=e.start,t=e.end,r=o.useReducer((function(e,n){return e+1}),0),s=(0,_.Z)(r,2),i=(s[0],s[1]);o.useEffect((function(){if(!t){var e=setInterval(i,6e4);return function(){return clearInterval(e)}}}),[n,t]);var a=t?t-n:Date.now()-n;return(0,C.jsx)("span",{children:pe(a)})},he=(0,u.Ps)(i||(i=(0,l.Z)(["\n  query BackfillStatusesByAsset($backfillId: String!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ...PartitionBackfillFragment\n      ...PythonErrorFragment\n      ... on BackfillNotFoundError {\n        message\n      }\n    }\n  }\n\n  fragment PartitionBackfillFragment on PartitionBackfill {\n    id\n    status\n    timestamp\n    endTimestamp\n    numPartitions\n    error {\n      ...PythonErrorFragment\n    }\n    assetBackfillData {\n      rootAssetTargetedRanges {\n        start\n        end\n      }\n      rootAssetTargetedPartitions\n      assetBackfillStatuses {\n        ... on AssetPartitionsStatusCounts {\n          assetKey {\n            path\n          }\n          numPartitionsTargeted\n          numPartitionsInProgress\n          numPartitionsMaterialized\n          numPartitionsFailed\n        }\n        ... on UnpartitionedAssetStatus {\n          assetKey {\n            path\n          }\n          inProgress\n          materialized\n          failed\n        }\n      }\n    }\n  }\n  ","\n"])),v.B),fe=function(e){var n,t,r=e.numPartitions,s=e.rootAssetTargetedRanges,i=e.rootAssetTargetedPartitions,a=o.useState(!1),l=(0,_.Z)(a,2),c=l[0],d=l[1];if(i)i.length>3?(n=(0,C.jsx)("div",{children:i.map((function(e){return(0,C.jsx)("div",{style:{maxWidth:"100px"},children:(0,C.jsx)(te.rd,{text:e})},e)}))}),t=(0,C.jsxs)(M.Z,{onClick:function(){d(!0)},children:[ie.V.format(r)," partitions"]})):t=(0,C.jsx)(x.x,{flex:{direction:"row",gap:8,wrap:"wrap"},children:i.map((function(e){return(0,C.jsx)("div",{children:e},e)}))});else if(1===(null===s||void 0===s?void 0:s.length)){var u=s[0],h=u.start,f=u.end;t=(0,C.jsxs)("div",{children:[h,"...",f]})}else t=(0,C.jsxs)(M.Z,{onClick:function(){d(!0)},children:[ie.V.format(r)," partitions"]}),n=(0,C.jsx)(x.x,{flex:{direction:"column",gap:8},children:null===s||void 0===s?void 0:s.map((function(e){return(0,C.jsxs)("div",{children:[e.start,"...",e.end]},"".concat(e.start,":").concat(e.end))}))});return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{children:t}),(0,C.jsxs)(D.Vq,{isOpen:!!n&&c,title:"Partition selection",children:[(0,C.jsx)(D.a7,{children:n}),(0,C.jsx)(D.cN,{topBorder:!0,children:(0,C.jsx)(V.zx,{onClick:function(){return d(!1)},children:"Close"})})]})]})},pe=function(e){var n=Math.floor(e/1e3%60),t=Math.floor(e/6e4%60),r=Math.floor(e/36e5%24),s=Math.floor(e/864e5),i="";return s>0?(i+="".concat(s,"d "),i+="".concat(r,"h")):r>0?(i+="".concat(r,"h "),i+="".concat(t,"m")):t>0&&(i+="".concat(t,"m "),i+="".concat(n,"s")),i.trim()},xe=F.ZP.button.withConfig({displayName:"BackfillPage__TagButton",componentId:"sc-19sdlda-1"})(["border:none;background:none;cursor:pointer;padding:0;margin:0;:focus{outline:none;}"]),ge=t(79962),me=t(94232),ve=t(80923),je=t(2838),ye=t(61623),we=t(33290),be=t(85357),ke=t(25626),Se=t(1497),Ce=t(65778),Ae=t(46089),Ee=t(31127),Te=t(46860),Ne=t(12434),Ie=t(93015),Oe=t(66708),Re=t(63167),Le=function(e){var n,t=e.Header,r=e.TabButton;(0,w.Px)(),(0,b.j)("Overview | Assets");var s=(0,d.a)(Ee.C1,{notifyOnNetworkStatusChange:!0}),i=(0,y.C4)(s,y.dT),a=o.useMemo((function(){var e;return"AssetConnection"===(null===(e=s.data)||void 0===e?void 0:e.assetsOrError.__typename)?function(e){var n={};return e.forEach((function(e){if(e.definition){var t=e.definition.groupName,r=e.definition.repository.name,s="".concat(t,"||").concat(r),i=n[s]||{groupName:t,repositoryName:r,assets:[]};i.assets.push(e),n[s]=i}})),Object.values(n)}(s.data.assetsOrError.nodes):[]}),[null===(n=s.data)||void 0===n?void 0:n.assetsOrError]),l=(0,Te.q)({queryKey:"q",decode:function(e){return e.searchQuery?JSON.parse(e.searchQuery):""},encode:function(e){return{searchQuery:e?JSON.stringify(e):void 0}}}),c=(0,_.Z)(l,2),u=c[0],h=c[1],f=o.useMemo((function(){return""===u?a:a.filter((function(e){return(e.groupName||Fe).toLowerCase().includes(u.toLowerCase())||e.repositoryName.toLowerCase().includes(u.toLowerCase())}))}),[a,u]),p=o.useRef(null),g=(0,ke.useVirtualizer)({count:f.length,getScrollElement:function(){return p.current},estimateSize:function(){return 82},overscan:5}),m=g.getTotalSize(),v=g.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("div",{style:{position:"sticky",top:0,zIndex:1},children:[(0,C.jsx)(t,{refreshState:i}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",gap:12,grow:0},children:[(0,C.jsx)(r,{selected:"assets"}),(0,C.jsx)(ve.oi,{value:u,onChange:function(e){h(e.target.value)},placeholder:"Filter asset groups\u2026"})]})]}),function(){var e,n=null===(e=s.data)||void 0===e?void 0:e.assetsOrError;return!s.data&&s.loading?(0,C.jsx)(x.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,C.jsx)(Z.$,{purpose:"page"})}):"PythonError"===(null===n||void 0===n?void 0:n.__typename)?(0,C.jsx)(x.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,C.jsx)(j.T9,{error:n})}):(0,C.jsx)(x.x,{flex:{direction:"column"},style:{overflow:"hidden"},children:(0,C.jsxs)(Ie.W2,{ref:p,children:[(0,C.jsx)(_e,{}),(0,C.jsx)(Ie.Nh,{$totalHeight:m,children:v.map((function(e){var n=e.index,t=e.key,r=e.size,s=e.start,i=f[n];return(0,C.jsx)(Ze,{start:s,height:r,group:i},t)}))})]})})}()]})};var Pe="5fr 1fr 1fr 1fr 1fr";function _e(){return(0,C.jsxs)(x.x,{border:{side:"horizontal",width:1,color:U.w.KeylineGray},style:{display:"grid",gridTemplateColumns:Pe,height:"32px",fontSize:"12px",color:U.w.Gray600,position:"sticky",top:0,zIndex:1,background:U.w.White},children:[(0,C.jsx)(Ie.qN,{children:"Group name"}),(0,C.jsx)(Ie.qN,{children:"Missing"}),(0,C.jsx)(Ie.qN,{children:"Failed/Overdue"}),(0,C.jsx)(Ie.qN,{children:"In progress"}),(0,C.jsx)(Ie.qN,{children:"Materialized"})]})}var Fe="Ungrouped Assets";function Ze(e){var n,t,r=e.height,s=e.start,i=e.group,a=o.useMemo((function(){return i.assets.map((function(e){return{path:e.key.path}}))}),[i.assets]),l=(0,Ce.le)(a).liveDataByNode,d=o.useMemo((function(){var e={successful:[],failed:[],inprogress:[],missing:[],loading:!1};return Object.keys(l).length?(Object.keys(l).forEach((function(n){var t=l[n],r=i.assets.find((function(e){return(0,X.Wu)(e.key)===n}));r.definition||console.warn("Expected a definition for asset with key",n);var s=(0,Se.D5)({assetKey:{path:JSON.parse(n)},definition:r.definition,liveData:t,expanded:!0});switch(s.case){case Se.KB.LOADING:e.loading=!0;break;case Se.KB.SOURCE_OBSERVING:e.inprogress.push({asset:r,status:s});break;case Se.KB.SOURCE_OBSERVED:e.successful.push({asset:r,status:s});break;case Se.KB.SOURCE_NEVER_OBSERVED:case Se.KB.SOURCE_NO_STATE:e.missing.push({asset:r,status:s});break;case Se.KB.MATERIALIZING:e.inprogress.push({asset:r,status:s});break;case Se.KB.LATE_OR_FAILED:e.failed.push({asset:r,status:s});break;case Se.KB.NEVER_MATERIALIZED:e.missing.push({asset:r,status:s});break;case Se.KB.MATERIALIZED:e.successful.push({asset:r,status:s});break;case Se.KB.PARTITIONS_FAILED:e.failed.push({asset:r,status:s});break;case Se.KB.PARTITIONS_MISSING:e.missing.push({asset:r,status:s});break;case Se.KB.PARTITIONS_MATERIALIZED:e.successful.push({asset:r,status:s})}})),e):(e.loading=!0,e)}),[l,i.assets]),u=null===(n=i.assets.find((function(e){var n;return null===(n=e.definition)||void 0===n?void 0:n.repository})))||void 0===n||null===(t=n.definition)||void 0===t?void 0:t.repository,h=(0,Oe.kQ)((null===u||void 0===u?void 0:u.name)||"",(null===u||void 0===u?void 0:u.location.name)||""),f=(0,je.S)(),p=f.containerProps,g=f.viewport;return(0,C.jsx)(Ie.X2,{$height:r,$start:s,children:(0,C.jsxs)(ze,{border:{side:"bottom",width:1,color:U.w.KeylineGray},children:[(0,C.jsx)(Be,{children:(0,C.jsxs)(x.x,{flex:{direction:"column",gap:2},children:[(0,C.jsxs)(x.x,{flex:{direction:"row",gap:8},children:[(0,C.jsx)(ye.JO,{name:"asset_group"}),i.groupName?(0,C.jsx)(J.rU,{style:{fontWeight:700},to:(0,Re.$U)(h,"/asset-groups/".concat(i.groupName)),children:i.groupName}):Fe]}),(0,C.jsx)("div",(0,c.Z)((0,c.Z)({},p),{},{children:(0,C.jsx)(Ue,{maxWidth:g.width,children:(0,C.jsx)(Ne.b,{repoAddress:h,showRefresh:!1})})}))]})}),(0,C.jsx)(Be,{isLoading:!!d.loading,children:d.missing.length?(0,C.jsx)(Me,{assets:d.missing,getCount:function(e){var n=e.status;return n.case===Se.KB.PARTITIONS_MISSING&&n.numMissing||0},adjective:"missing",children:(0,C.jsx)(B.V,{intent:"none",children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,C.jsx)("div",{style:{width:"12px",height:"12px",border:"2px solid ".concat(U.w.Gray500),borderRadius:"50%"}}),d.missing.length]})})}):0}),(0,C.jsx)(Be,{isLoading:!!d.loading,children:d.failed.length?(0,C.jsx)(Me,{assets:d.failed,getCount:function(e){var n=e.status;return n.case===Se.KB.PARTITIONS_FAILED&&n.numFailed||0},adjective:"failed",children:(0,C.jsx)(B.V,{intent:"danger",children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,C.jsx)("div",{style:{width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"10px solid red",display:"inline-block"}}),d.failed.length]})})}):0}),(0,C.jsx)(Be,{isLoading:!!d.loading,children:d.inprogress.length?(0,C.jsx)(Me,{assets:d.inprogress,getCount:function(e){var n=e.status;return n.case===Se.KB.MATERIALIZING&&n.numMaterializing||0},adjective:"materializing",children:(0,C.jsx)(B.V,{intent:"primary",icon:"spinner",children:d.inprogress.length})}):0}),(0,C.jsx)(Be,{isLoading:!!d.loading,children:d.successful.length?(0,C.jsx)(Me,{assets:d.successful,getCount:function(e){var n=e.status;return n.case===Se.KB.PARTITIONS_MATERIALIZED&&n.numMaterialized||0},adjective:"materialized",children:(0,C.jsx)(B.V,{intent:"success",children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,C.jsx)("div",{style:{backgroundColor:U.w.Green500,width:"10px",height:"10px",borderRadius:"50%"}}),d.successful.length]})})}):0})]})})}var ze=(0,F.ZP)(x.x).withConfig({displayName:"OverviewAssetsRoot__RowGrid",componentId:"sc-usswh5-0"})(["display:grid;grid-template-columns:",";height:100%;> *{padding-top:26px 0px;}"],Pe),Be=function(e){var n=e.children,t=e.isLoading;return(0,C.jsx)(Ie.E5,{style:{color:U.w.Gray900},children:t?(0,C.jsx)(x.x,{flex:{justifyContent:"center",alignItems:"center"},style:{height:"82px"},children:(0,C.jsx)(Z.$,{purpose:"body-text"})}):(0,C.jsx)(x.x,{flex:{direction:"row",alignItems:"center",grow:1},children:n})})},Ue=F.ZP.div.withConfig({displayName:"OverviewAssetsRoot__RepositoryLinkWrapper",componentId:"sc-usswh5-1"})(["font-size:12px;pointer-events:none;a{color:",";pointer-events:none;max-width:",";}"],U.w.Gray600,(function(e){var n=e.maxWidth;return n?"unset":"".concat(n,"px")}));function Me(e){var n=e.assets,t=e.children,r=e.getCount,s=e.adjective;return(0,C.jsx)(Je,{children:(0,C.jsx)(we.P,{items:n,itemPredicate:function(e,n){return(0,X.ll)(n.asset.key).toLocaleLowerCase().includes(e.toLocaleLowerCase())},itemRenderer:function(e){var n=r(e);return(0,C.jsx)(He,{to:(0,ee.p)(e.asset.key),target:"_blank",children:(0,C.jsx)(be.sN,{text:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:4},children:[(0,C.jsx)("div",{style:{paddingLeft:"4px"},children:(0,C.jsx)(ye.JO,{name:"asset"})}),(0,C.jsx)("div",{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:(0,X.ll)(e.asset.key)}),n&&n>0?(0,C.jsxs)(p.YS,{style:{color:U.w.Gray700},children:[(0,Ae._e)(n)," ",s]}):null]})},(0,X.ll)(e.asset.key))})},onItemSelect:function(){},children:t})})}var De,Ve,qe,Ke,Ge,$e,We,Qe,Je=F.ZP.div.withConfig({displayName:"OverviewAssetsRoot__SelectWrapper",componentId:"sc-usswh5-2"})(["cursor:pointer;&:hover{font-weight:600;}"]),He=(0,F.ZP)(J.rU).withConfig({displayName:"OverviewAssetsRoot__LinkWithNoUnderline",componentId:"sc-usswh5-3"})(["&:hover{text-decoration:none;}"]),Ye=t(21189),Xe=t(17868),en=t(15682),nn=t(49020),tn=t(56666),rn=t(41361),sn=t(68079),on=(0,u.Ps)(De||(De=(0,l.Z)(["\n  fragment ScheduleFutureTicksFragment on Schedule {\n    id\n    executionTimezone\n    scheduleState {\n      id\n      status\n    }\n    futureTicks(cursor: $tickCursor, until: $ticksUntil) {\n      results {\n        timestamp\n      }\n    }\n  }\n"]))),an=t(9610),ln=t(20967),cn=t(89622),dn=t(4296),un=function(e,n){return"".concat(n,"-").concat((0,an.Uz)(e))},hn=(0,u.Ps)(Ve||(Ve=(0,l.Z)(["\n  query RunTimelineQuery(\n    $inProgressFilter: RunsFilter!\n    $terminatedFilter: RunsFilter!\n    $tickCursor: Float\n    $ticksUntil: Float\n  ) {\n    unterminated: runsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    terminated: runsOrError(filter: $terminatedFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          name\n          loadStatus\n          displayMetadata {\n            key\n            value\n          }\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n                schedules {\n                  id\n                  name\n                  pipelineName\n                  scheduleState {\n                    id\n                    status\n                  }\n                  ...ScheduleFutureTicksFragment\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n"])),cn.$X,on),fn=t(92761),pn=36e5,xn=function(e){switch(e){case"1":return pn;case"6":return 216e5;case"12":return 432e5;case"24":return 864e5}},gn=function(e){var n=e.Header,t=e.TabButton;(0,w.Px)(),(0,b.j)("Overview | Timeline");var r=o.useContext(fn.C5),s=r.allRepos,i=r.visibleRepos,a=function(e){var n=o.useCallback((function(n){switch(n){case"1":case"6":case"12":case"24":return n;default:return e}}),[e]),t=(0,ge.U)("dagit.run-timeline-hour-window",n),r=(0,_.Z)(t,2),s=r[0],i=r[1],a=o.useCallback((function(n){i(n||e)}),[e,i]);return o.useMemo((function(){return[s,a]}),[s,a])}("12"),l=(0,_.Z)(a,2),u=l[0],h=l[1],f=o.useState((function(){return Date.now()})),p=(0,_.Z)(f,2),g=p[0],m=p[1],v=o.useState((function(){return 0})),j=(0,_.Z)(v,2),k=j[0],S=j[1],A=(0,Te.q)({queryKey:"search",defaults:{search:""}}),E=(0,_.Z)(A,2),T=E[0],N=E[1];o.useEffect((function(){m(Date.now());var e=setInterval((function(){m(Date.now())}),6e4);return function(){clearInterval(e)}}),[u]);var I=o.useCallback((function(){S((function(e){return e-xn(u)}))}),[u]),O=o.useCallback((function(){S((function(e){return e+xn(u)}))}),[u]),R=o.useCallback((function(){S(0)}),[]),L=o.useMemo((function(){return[g-Number(u)*pn+k,g+36e5+k]}),[u,g,k]),P=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,_.Z)(e,2),r=t[0],s=t[1],i=r/1e3,a=s/1e3,l=(0,d.a)(hn,{notifyOnNetworkStatusChange:!0,variables:{inProgressFilter:(0,c.Z)((0,c.Z)({},n),{},{statuses:[ne.VOA.CANCELING,ne.VOA.STARTED],createdBefore:a}),terminatedFilter:(0,c.Z)((0,c.Z)({},n),{},{statuses:Array.from(ln.cv),createdBefore:a,updatedAfter:i}),tickCursor:i,ticksUntil:a}}),u=l.data,h=l.previousData,f=l.loading&&!u,p=u||h||{},x=p.unterminated,g=p.terminated,m=p.workspaceOrError,v=o.useMemo((function(){var e={},n=Date.now();return[].concat((0,sn.Z)("Runs"===(null===x||void 0===x?void 0:x.__typename)?x.results:[]),(0,sn.Z)("Runs"===(null===g||void 0===g?void 0:g.__typename)?g.results:[])).forEach((function(t){if(t.startTime&&t.repositoryOrigin&&(0,dn.a)({start:r,end:s},{start:1e3*t.startTime,end:t.endTime?1e3*t.endTime:n})){var i=un({name:t.repositoryOrigin.repositoryName,location:t.repositoryOrigin.repositoryLocationName},t.pipelineName);e[i]=[].concat((0,sn.Z)(e[i]||[]),[{id:t.id,status:t.status,startTime:1e3*t.startTime,endTime:t.endTime?1e3*t.endTime:n}])}})),e}),[s,x,g,r]),j=o.useMemo((function(){if(!m||"Workspace"!==m.__typename)return[];var e,n=[],t=(0,rn.Z)(m.locationEntries);try{var i=function(){var t,i=e.value;if("WorkspaceLocationEntry"!==i.__typename||"RepositoryLocation"!==(null===(t=i.locationOrLoadError)||void 0===t?void 0:t.__typename))return"continue";var o,a=Date.now(),l=(0,rn.Z)(i.locationOrLoadError.repositories);try{var c=function(){var e,t=o.value,l=(0,Oe.kQ)(t.name,i.locationOrLoadError.name),c=(0,rn.Z)(t.pipelines);try{var d=function(){var i,o=e.value,c=(t.schedules||[]).filter((function(e){return e.pipelineName===o.name})),d=[],u=(0,rn.Z)(c);try{var h=function(){var e=i.value;e.scheduleState.status===ne.ynu.RUNNING&&e.futureTicks.results.forEach((function(n){var t=n.timestamp,i=1e3*t;i>a&&(0,dn.a)({start:r,end:s},{start:i,end:i})&&d.push({id:"".concat(e.pipelineName,"-future-run-").concat(t),status:"SCHEDULED",startTime:i,endTime:i+5e3})}))};for(u.s();!(i=u.n()).done;)h()}catch(w){u.e(w)}finally{u.f()}var f=(0,X.pv)(o.name),p=un(l,o.name),x=f?"Ad hoc materializations":o.name,g=v[p]||[];if(!d.length&&!g.length)return"continue";var m=[].concat((0,sn.Z)(g),d);if(f){var j,y=n.find((function(e){return"asset"===e.jobType&&e.repoAddress===l}));if(y)return(j=y.runs).push.apply(j,(0,sn.Z)(m)),"continue"}n.push({key:p,jobName:x,jobType:f?"asset":"job",repoAddress:l,path:(0,Re.jT)({repoName:l.name,repoLocation:l.location,pipelineName:o.name,isJob:o.isJob}),runs:[].concat((0,sn.Z)(g),d)})};for(c.s();!(e=c.n()).done;)d()}catch(u){c.e(u)}finally{c.f()}};for(l.s();!(o=l.n()).done;)c()}catch(d){l.e(d)}finally{l.f()}};for(t.s();!(e=t.n()).done;)i()}catch(a){t.e(a)}finally{t.f()}var o=n.reduce((function(e,n){var t=n.runs.map((function(e){return e.startTime}));return(0,c.Z)((0,c.Z)({},e),{},(0,tn.Z)({},n.key,Math.min.apply(Math,(0,sn.Z)(t))))}),{});return n.sort((function(e,n){return o[e.key]-o[n.key]}))}),[m,v,r,s]);return o.useMemo((function(){return{jobs:j,initialLoading:f,queryData:l}}),[f,j,l])}(L),F=P.jobs,Z=P.initialLoading,z=P.queryData,B=(0,y.C4)(z,y.dT),U=o.useMemo((function(){var e=T.toLocaleLowerCase().trim(),n=i.flatMap((function(n){var t=(0,Oe.kQ)(n.repository.name,n.repositoryLocation.name);return n.repository.pipelines.filter((function(n){return n.name.toLocaleLowerCase().includes(e)})).map((function(e){return un(t,e.name)}))}));return new Set(n)}),[i,T]),M=o.useMemo((function(){return F.filter((function(e){var n=e.key;return U.has(n)}))}),[F,U]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(n,{refreshState:B}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",justifyContent:"space-between"},children:[(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[(0,C.jsx)(t,{selected:"timeline"}),s.length>1&&(0,C.jsx)(en.C,{}),(0,C.jsx)(ve.oi,{icon:"search",value:T,onChange:function(e){return N(e.target.value)},placeholder:"Filter by job name\u2026",style:{width:"200px"}})]}),(0,C.jsxs)(x.x,{flex:{direction:"row",gap:16,alignItems:"center"},children:[(0,C.jsx)(Ye.h,{activeItems:new Set([u]),buttons:[{id:"1",label:"1hr"},{id:"6",label:"6hr"},{id:"12",label:"12hr"},{id:"24",label:"24hr"}],onClick:function(e){return h(e)}}),(0,C.jsxs)(x.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,C.jsx)(V.zx,{onClick:I,children:"\u2190"}),(0,C.jsx)(V.zx,{onClick:R,children:"Now"}),(0,C.jsx)(V.zx,{onClick:O,children:"\u2192"})]})]})]}),(0,C.jsx)(Xe.S,{region:"timeline",children:(0,C.jsx)(nn.q,{loading:Z,range:L,jobs:M})})]})},mn=function(){(0,w.Px)(),(0,b.j)("Overview | Activity");var e=o.useCallback((function(e){var n=e.refreshState;return(0,C.jsx)(f.m,{title:(0,C.jsx)(p.X6,{children:"Overview"}),tabs:(0,C.jsx)(A,{tab:"activity",refreshState:n})})}),[]),n=(0,ge.U)("overview-activity-tab",(function(e){return["timeline","assets"].includes(e)?e:"timeline"})),t=(0,_.Z)(n,2),r=t[0],s=t[1],i=o.useCallback((function(e){var n=e.selected;return r!==n&&s(n),(0,C.jsxs)(V.zH,{children:[(0,C.jsx)(me.Q1,{$active:"timeline"===n,to:"/overview/activity/timeline",children:"Timeline"}),(0,C.jsx)(me.Q1,{$active:"assets"===n,to:"/overview/activity/assets",children:"Assets"})]})}),[r,s]);return(0,C.jsx)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:(0,C.jsxs)(a.rs,{children:[(0,C.jsx)(a.AW,{path:"/overview/activity/assets",children:(0,C.jsx)(Le,{Header:e,TabButton:i})}),(0,C.jsx)(a.AW,{path:"/overview/activity/timeline",children:(0,C.jsx)(gn,{Header:e,TabButton:i})}),(0,C.jsx)(a.AW,{path:"*",render:o.useCallback((function(){return"timeline"===r?(0,C.jsx)(a.l_,{to:"/overview/activity/timeline"}):(0,C.jsx)(a.l_,{to:"/overview/activity/assets"})}),[r])})]})})},vn=t(44229),jn=t(12735),yn=t(1628),wn=t(53209),bn=t(54858),kn=t(1780),Sn=function(e){var n=e.repos,t=o.useRef(null),r=o.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,an.Uz)(n)}))}),[n]),s=(0,yn.N)(kn.y,r),i=s.expandedKeys,a=s.onToggle,l=s.onToggleAll,c=o.useMemo((function(){var e=[];return n.forEach((function(n){var t=n.repoAddress,r=n.jobs;e.push({type:"header",repoAddress:t,jobCount:r.length});var s=(0,an.Uz)(t);i.includes(s)&&r.forEach((function(n){var r=n.isJob,s=n.name;e.push({type:"job",repoAddress:t,isJob:r,name:s})}))})),e}),[n,i]),d=(0,jn.w)(n.map((function(e){return e.repoAddress.name}))),u=(0,ke.useVirtualizer)({count:c.length,getScrollElement:function(){return t.current},estimateSize:function(e){var n=c[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),h=u.getTotalSize(),f=u.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(wn.I,{}),(0,C.jsx)("div",{style:{overflow:"hidden"},children:(0,C.jsx)(Ie.W2,{ref:t,children:(0,C.jsx)(Ie.Nh,{$totalHeight:h,children:f.map((function(e){var n=e.index,t=e.key,r=e.size,s=e.start,o=c[n];return"header"===o.type?(0,C.jsx)(bn.vG,{repoAddress:o.repoAddress,height:r,start:s,onToggle:a,onToggleAll:l,expanded:i.includes((0,an.Uz)(o.repoAddress)),showLocation:d.has(o.repoAddress.name),rightElement:(0,C.jsx)(vn.u,{content:1===o.jobCount?"1 job":"".concat(o.jobCount," jobs"),placement:"top",children:(0,C.jsx)(B.V,{children:o.jobCount})})},t):(0,C.jsx)(wn.b,{name:o.name,isJob:o.isJob,repoAddress:o.repoAddress,height:r,start:s},t)}))})})})]})},Cn=function(e){return(0,sn.Z)(e).sort((function(e,n){var t=(0,an.Uz)(e.repoAddress),r=(0,an.Uz)(n.repoAddress);return t.localeCompare(r)}))},An=function(e){return new Set(e.map((function(e){return(0,an.Uz)((0,Oe.kQ)(e.repository.name,e.repositoryLocation.name))})))},En=function(){(0,w.Px)(),(0,b.j)("Overview | Jobs");var e=o.useContext(fn.C5),n=e.allRepos,t=e.visibleRepos,r=(0,Te.q)({queryKey:"search",defaults:{search:""}}),s=(0,_.Z)(r,2),i=s[0],a=s[1],l=n.length,c=(0,d.a)(Nn,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,m=(0,y.C4)(c,y.dT),v=o.useMemo((function(){var e=An(t);return Tn(u).filter((function(n){var t=n.repoAddress;return e.has((0,an.Uz)(t))}))}),[u,t]),j=i.trim().toLocaleLowerCase(),k=j.length>0,S=o.useMemo((function(){var e=j.toLocaleLowerCase();return v.map((function(n){return{repoAddress:n.repoAddress,jobs:n.jobs.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.jobs.length>0}))}),[v,j]);return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(f.m,{title:(0,C.jsx)(p.X6,{children:"Overview"}),tabs:(0,C.jsx)(A,{tab:"jobs",refreshState:m})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[l>1?(0,C.jsx)(en.C,{}):null,(0,C.jsx)(ve.oi,{icon:"search",value:i,onChange:function(e){return a(e.target.value)},placeholder:"Filter by job name\u2026",style:{width:"340px"}})]}),h&&!l?(0,C.jsx)(x.x,{padding:64,children:(0,C.jsx)(Z.$,{purpose:"page"})}):function(){if(h&&!u)return(0,C.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,C.jsx)(Z.$,{purpose:"body-text"}),(0,C.jsx)("div",{style:{color:U.w.Gray600},children:"Loading jobs\u2026"})]})});var e=n.length>t.length;return S.length?(0,C.jsx)(Sn,{repos:S}):k?(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(g.t,{icon:"search",title:"No matching jobs",description:e?(0,C.jsxs)("div",{children:["No jobs matching ",(0,C.jsx)("strong",{children:i})," were found in the selected code locations"]}):(0,C.jsxs)("div",{children:["No jobs matching ",(0,C.jsx)("strong",{children:i})," were found in your definitions"]})})}):(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(g.t,{icon:"search",title:"No jobs",description:e?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})}()]})},Tn=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,t=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),r=[],s=(0,rn.Z)(t);try{for(s.s();!(n=s.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var o,a=(0,rn.Z)(i.repositories);try{for(a.s();!(o=a.n()).done;){var l=o.value,c=l.name,d=l.pipelines,u=(0,Oe.kQ)(c,i.name),h=d.filter((function(e){var n=e.name;return!(0,X.pv)(n)})).map((function(e){return{isJob:e.isJob,name:e.name}}));h.length>0&&r.push({repoAddress:u,jobs:h})}}catch(f){a.e(f)}finally{a.f()}}}}catch(f){s.e(f)}finally{s.f()}return Cn(r)},Nn=(0,u.Ps)(qe||(qe=(0,l.Z)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"])),v.B),In=t(51737),On=t(2268),Rn=function(e){var n=e.repos,t=o.useRef(null),r=o.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,an.Uz)(n)}))}),[n]),s=(0,yn.N)(kn.y,r),i=s.expandedKeys,a=s.onToggle,l=s.onToggleAll,d=o.useMemo((function(){var e=[];return n.forEach((function(n){var t=n.repoAddress,r=n.resources;e.push({type:"header",repoAddress:t,resourceCount:r.length});var s=(0,an.Uz)(t);i.includes(s)&&r.forEach((function(n){e.push((0,c.Z)({type:"resource",repoAddress:t},n))}))})),e}),[n,i]),u=(0,jn.w)(n.map((function(e){return e.repoAddress.name}))),h=(0,ke.useVirtualizer)({count:d.length,getScrollElement:function(){return t.current},estimateSize:function(e){var n=d[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),f=h.getTotalSize(),p=h.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(On.f,{}),(0,C.jsx)("div",{style:{overflow:"hidden"},children:(0,C.jsx)(Ie.W2,{ref:t,children:(0,C.jsx)(Ie.Nh,{$totalHeight:f,children:p.map((function(e){var n=e.index,t=e.key,r=e.size,s=e.start,o=d[n];return"header"===o.type?(0,C.jsx)(bn.vG,{repoAddress:o.repoAddress,height:r,start:s,onToggle:a,onToggleAll:l,expanded:i.includes((0,an.Uz)(o.repoAddress)),showLocation:u.has(o.repoAddress.name),rightElement:(0,C.jsx)(vn.u,{content:1===o.resourceCount?"1 resource":"".concat(o.resourceCount," resources"),placement:"top",children:(0,C.jsx)(B.V,{children:o.resourceCount})})},t):(0,C.jsx)(On.K,(0,c.Z)({height:r,start:s},o),t)}))})})})]})},Ln=function(){(0,w.Px)(),(0,b.j)("Overview | Resources");var e=o.useContext(fn.C5),n=e.allRepos,t=e.visibleRepos,r=(0,Te.q)({queryKey:"search",defaults:{search:""}}),s=(0,_.Z)(r,2),i=s[0],a=s[1],l=n.length,c=(0,d.a)(_n,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,m=(0,y.C4)(c,y.dT),v=o.useMemo((function(){var e=An(t);return Pn(u).filter((function(n){var t=n.repoAddress;return e.has((0,an.Uz)(t))}))}),[u,t]),j=i.trim().toLocaleLowerCase(),k=j.length>0,S=o.useMemo((function(){var e=j.toLocaleLowerCase();return v.map((function(n){return{repoAddress:n.repoAddress,resources:n.resources.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.resources.length>0}))}),[v,j]);return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(f.m,{title:(0,C.jsx)(p.X6,{children:"Overview"}),tabs:(0,C.jsx)(A,{tab:"resources",refreshState:m})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[l>1?(0,C.jsx)(en.C,{}):null,(0,C.jsx)(ve.oi,{icon:"search",value:i,onChange:function(e){return a(e.target.value)},placeholder:"Filter by resource name\u2026",style:{width:"340px"}})]}),h&&!l?(0,C.jsx)(x.x,{padding:64,children:(0,C.jsx)(Z.$,{purpose:"page"})}):function(){if(h&&!u)return(0,C.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,C.jsx)(Z.$,{purpose:"body-text"}),(0,C.jsx)("div",{style:{color:U.w.Gray600},children:"Loading resources\u2026"})]})});var e=n.length>t.length;return S.length?(0,C.jsx)(Rn,{repos:S}):k?(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(g.t,{icon:"search",title:"No matching resources",description:e?(0,C.jsxs)("div",{children:["No resources matching ",(0,C.jsx)("strong",{children:i})," were found in the selected code locations"]}):(0,C.jsxs)("div",{children:["No resources matching ",(0,C.jsx)("strong",{children:i})," were found in your definitions"]})})}):(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(g.t,{icon:"search",title:"No resources",description:e?"No resources were found in the selected code locations":"No resources were found in your definitions"})})}()]})},Pn=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,t=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),r=[],s=(0,rn.Z)(t);try{for(s.s();!(n=s.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var o,a=(0,rn.Z)(i.repositories);try{for(a.s();!(o=a.n()).done;){var l=o.value,c=l.name,d=l.allTopLevelResourceDetails,u=(0,Oe.kQ)(c,i.name);d.length>0&&r.push({repoAddress:u,resources:d})}}catch(h){a.e(h)}finally{a.f()}}}}catch(h){s.e(h)}finally{s.f()}return Cn(r)},_n=(0,u.Ps)(Ke||(Ke=(0,l.Z)(["\n  query OverviewResourcesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                allTopLevelResourceDetails {\n                  ...ResourceEntryFragment\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),v.B,In.L),Fn=t(59740),Zn=t(16255),zn=t(97734),Bn=t(60929),Un=t(32723),Mn=t(34795),Dn=t(15541),Vn=t(17914),qn=t(4537),Kn=t(87919),Gn=t(35740),$n=t(3069),Wn=t(65033),Qn=t(78595),Jn=t(90696),Hn=t(88508),Yn=function(e){var n=e.sensorStates,t=e.showSubheading,r=void 0===t||t;return n.length?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(x.x,{padding:{vertical:16,horizontal:20},children:[r?(0,C.jsx)(p.pm,{children:"Unloadable sensors"}):null,(0,C.jsx)(et,{})]}),(0,C.jsxs)(z.i,{children:[(0,C.jsx)("thead",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{style:{maxWidth:"60px"}}),(0,C.jsx)("th",{children:"Sensor name"}),(0,C.jsx)("th",{style:{width:"100px"},children:"Last tick"}),(0,C.jsx)("th",{children:"Last run"})]})}),(0,C.jsx)("tbody",{children:n.map((function(e){return(0,C.jsx)(tt,{sensorState:e},e.id)}))})]})]}):null},Xn=function(e){var n=e.scheduleStates,t=e.showSubheading,r=void 0===t||t;return n.length?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(x.x,{padding:{vertical:16,horizontal:20},children:[r?(0,C.jsx)(p.pm,{children:"Unloadable schedules"}):null,(0,C.jsx)(nt,{})]}),(0,C.jsxs)(z.i,{children:[(0,C.jsx)("thead",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{style:{maxWidth:"60px"}}),(0,C.jsx)("th",{children:"Schedule name"}),(0,C.jsx)("th",{style:{width:"150px"},children:"Schedule"}),(0,C.jsx)("th",{style:{width:"100px"},children:"Last tick"}),(0,C.jsx)("th",{children:"Last run"}),(0,C.jsx)("th",{children:"Partition set status"})]})}),(0,C.jsx)("tbody",{children:n.map((function(e){return(0,C.jsx)(rt,{scheduleState:e},e.id)}))})]})]}):null},et=function(){return(0,C.jsx)(Zn.b,{intent:"warning",title:(0,C.jsxs)("div",{children:["Note: You can turn off any of the following sensors, but you cannot turn them back on."," "]}),description:(0,C.jsx)("div",{children:"The following sensors were previously started but now cannot be loaded. They may be part of a different workspace or from a sensor or code location that no longer exists in code. You can turn them off, but you cannot turn them back on since they can\u2019t be loaded."})})},nt=function(){return(0,C.jsx)(Zn.b,{intent:"warning",title:(0,C.jsx)("div",{children:"Note: You can turn off any of the following schedules, but you cannot turn them back on."}),description:(0,C.jsx)("div",{children:"The following schedules were previously started but now cannot be loaded. They may be part of a different workspace or from a schedule or code location that no longer exists in code. You can turn them off, but you cannot turn them back on since they can\u2019t be loaded."})})},tt=function(e){var n=e.sensorState,t=n.id,r=n.selectorId,s=n.name,i=n.status,o=n.ticks,a=n.hasStopPermission,l=(0,Dn.D)(Qn.Xu,{onCompleted:Qn.oI}),c=(0,_.Z)(l,2),d=c[0],u=c[1].loading,h=(0,Kn.p)(),f=function(){var e=(0,Mn.Z)((0,Un.Z)().mark((function e(){return(0,Un.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i!==ne.ynu.RUNNING){e.next=4;break}return e.next=3,h({title:"Are you sure you want to turn off this sensor?",description:"The definition for this sensor is not available. If you turn it off, you will not be able to turn it back on from the currently loaded workspace."});case 3:d({variables:{jobOriginId:t,jobSelectorId:r}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=i===ne.ynu.RUNNING&&!a,x=o.length?o[0]:null;return(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{width:60},children:function(){var e=(0,C.jsx)(Vn.X,{format:"switch",disabled:u||i===ne.ynu.STOPPED||p,checked:i===ne.ynu.RUNNING,onChange:f});return p?(0,C.jsx)(vn.u,{content:Gn.Qr,children:e}):e}()}),(0,C.jsxs)("td",{children:[(0,C.jsx)(qn.Z,{direction:"row",spacing:8,alignItems:"center",children:s}),(0,C.jsx)(Jn.Y,{instigatorState:n})]}),(0,C.jsx)("td",{children:x?(0,C.jsx)(Hn.TW,{tick:x,instigationType:ne._5b.SENSOR}):(0,C.jsx)("span",{style:{color:U.w.Gray300},children:"None"})}),(0,C.jsx)("td",{children:(0,C.jsx)("div",{style:{display:"flex"},children:(0,C.jsx)(Bn.UD,{instigationState:n})})})]},s)},rt=function(e){var n=e.scheduleState,t=(0,Dn.D)($n.d0,{onCompleted:$n.JH}),r=(0,_.Z)(t,2),s=r[0],i=r[1].loading,o=(0,Kn.p)(),a=n.id,l=n.selectorId,c=n.name,d=n.ticks,u=n.status,h=n.typeSpecificData,f=d.length>0?d[0]:null,p=h&&"ScheduleData"===h.__typename?h.cronSchedule:null,x=function(){var e=(0,Mn.Z)((0,Un.Z)().mark((function e(){return(0,Un.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u!==ne.ynu.RUNNING){e.next=4;break}return e.next=3,o({title:"Are you sure you want to stop this schedule?",description:"The definition for this schedule is not available. If you turn it off, you will not be able to turn it back on from the currently loaded workspace."});case 3:s({variables:{scheduleOriginId:a,scheduleSelectorId:l}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=u===ne.ynu.RUNNING&&!n.hasStopPermission;return(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{width:60},children:function(){var e=(0,C.jsx)(Vn.X,{format:"switch",checked:u===ne.ynu.RUNNING,disabled:u!==ne.ynu.RUNNING||i||g,onChange:x});return g?(0,C.jsx)(vn.u,{content:Gn.Qr,children:e}):e}()}),(0,C.jsxs)("td",{children:[(0,C.jsx)(qn.Z,{direction:"row",spacing:8,alignItems:"center",children:(0,C.jsx)("div",{children:c})}),(0,C.jsx)(Jn.Y,{instigatorState:n})]}),(0,C.jsx)("td",{style:{maxWidth:150},children:(0,C.jsx)("div",{style:{position:"relative",width:"100%",whiteSpace:"pre-wrap",display:"block"},children:p?(0,C.jsx)(vn.u,{position:"bottom",content:p,children:(0,Wn.A)(p)}):(0,C.jsx)("div",{children:"\u2014"})})}),(0,C.jsx)("td",{children:f?(0,C.jsx)(Hn.TW,{tick:f,instigationType:ne._5b.SCHEDULE}):null}),(0,C.jsx)("td",{children:(0,C.jsx)(Bn.UD,{instigationState:n})}),(0,C.jsx)("td",{children:(0,C.jsx)("div",{style:{display:"flex"},children:"\u2014"})})]},c)},st=t(65606),it=t(18786),ot=t(33654),at=t(81815),lt=t(37200),ct=t(67035),dt=t(29678),ut=function(){var e=o.useContext(fn.C5),n=e.allRepos,t=e.visibleRepos,r=e.setVisible,s=e.setHidden,i=o.useMemo((function(){return n.map((function(e){return(0,Oe.kQ)(e.repository.name,e.repositoryLocation.name)}))}),[n]),a=o.useMemo((function(){return t.length===n.length?[]:t.map((function(e){return(0,Oe.kQ)(e.repository.name,e.repositoryLocation.name)}))}),[n,t]);return(0,dt.im)({name:"Code location",icon:"folder",initialState:a,allValues:i.map((function(e){return{value:e,match:[(0,an.Uz)(e)]}})),getKey:function(e){return(0,an.Uz)(e)},renderLabel:function(e){var n=e.value;return(0,C.jsx)(te.rd,{text:(0,an.Uz)(n)})},getStringValue:function(e){return(0,an.Uz)(e)},onStateChanged:function(e){if(0!==e.size){var n=i.filter((function(n){return!e.has(n)}));s(n),r(Array.from(e))}else r(i)},menuWidth:"500px"})},ht=t(75763),ft=t(99786),pt=t(159),xt=function(e){var n=e.repos,t=e.headerCheckbox,r=e.checkedKeys,s=e.onToggleCheckFactory,i=o.useRef(null),a=o.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,an.Uz)(n)}))}),[n]),l=(0,yn.N)(kn.y,a),c=l.expandedKeys,d=l.onToggle,u=l.onToggleAll,h=o.useMemo((function(){var e=[];return n.forEach((function(n){var t=n.repoAddress,r=n.schedules;e.push({type:"header",repoAddress:t,scheduleCount:r.length});var s=(0,an.Uz)(t);c.includes(s)&&r.forEach((function(n){e.push({type:"schedule",repoAddress:t,schedule:n})}))})),e}),[n,c]),f=(0,jn.w)(n.map((function(e){return e.repoAddress.name}))),p=(0,ke.useVirtualizer)({count:h.length,getScrollElement:function(){return i.current},estimateSize:function(e){var n=h[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),x=p.getTotalSize(),g=p.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(pt.o,{checkbox:t}),(0,C.jsx)("div",{style:{overflow:"hidden"},children:(0,C.jsx)(Ie.W2,{ref:i,children:(0,C.jsx)(Ie.Nh,{$totalHeight:x,children:g.map((function(e){var n=e.index,i=e.key,o=e.size,a=e.start,l=h[n];if("header"===l.type)return(0,C.jsx)(bn.vG,{repoAddress:l.repoAddress,height:o,start:a,onToggle:d,onToggleAll:u,expanded:c.includes((0,an.Uz)(l.repoAddress)),showLocation:f.has(l.repoAddress.name),rightElement:(0,C.jsx)(vn.u,{content:1===l.scheduleCount?"1 schedule":"".concat(l.scheduleCount," schedules"),placement:"top",children:(0,C.jsx)(B.V,{children:l.scheduleCount})})},i);var p=(0,at.g)(l.repoAddress,l.schedule.name);return(0,C.jsx)(pt.i,{name:l.schedule.name,scheduleState:l.schedule.scheduleState,showCheckboxColumn:!!t,checked:r.has(p),onToggleChecked:s(p),repoAddress:l.repoAddress,height:o,start:a},i)}))})})})]})},gt=["schedules"],mt=function(){(0,w.Px)(),(0,b.j)("Overview | Schedules");var e=o.useContext(fn.C5),n=e.allRepos,t=e.visibleRepos,r=n.length,s=(0,Te.q)({queryKey:"search",defaults:{search:""}}),i=(0,_.Z)(s,2),a=i[0],l=i[1],u=ut(),h=(0,ht.g)(),m=o.useMemo((function(){return[u,h]}),[u,h]),v=(0,ct.m)({filters:m}),j=v.button,k=v.activeFiltersJsx,S=(0,d.a)(wt,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),E=S.data,T=S.loading,N=(0,y.C4)(S,y.dT),I=o.useMemo((function(){var e=An(t);return yt(E).filter((function(n){var t=n.repoAddress;return e.has((0,an.Uz)(t))}))}),[E,t]),O=h.state,R=o.useMemo((function(){return I.map((function(e){var n=e.schedules,t=(0,Fn.Z)(e,gt);return(0,c.Z)((0,c.Z)({},t),{},{schedules:O.size?n.filter((function(e){var n=e.scheduleState;return O.has(n.status)})):n})}))}),[I,O]),L=a.trim().toLocaleLowerCase(),P=L.length>0,F=o.useMemo((function(){var e=L.toLocaleLowerCase();return R.map((function(n){return{repoAddress:n.repoAddress,schedules:n.schedules.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.schedules.length>0}))}),[R,L]),z=o.useMemo((function(){return F.some((function(e){return e.schedules.length>0}))}),[F]),B=o.useMemo((function(){return I.map((function(e){var n=e.repoAddress;return e.schedules.filter((function(e){var n=e.scheduleState;return(0,st.i)(n)})).map((function(e){var t=e.name,r=e.scheduleState;return{repoAddress:n,scheduleName:t,scheduleState:r}}))})).flat()}),[I]),M=o.useMemo((function(){return B.map((function(e){var n=e.repoAddress,t=e.scheduleName;return(0,at.g)(n,t)}))}),[B]),D=(0,zn.a)(M),V=(0,_.Z)(D,2),q=V[0].checkedIds,K=V[1],G=K.onToggleFactory,$=K.onToggleAll,W=o.useMemo((function(){var e=new Set(F.map((function(e){var n=e.repoAddress;return e.schedules.map((function(e){var t=e.name;return(0,at.g)(n,t)}))})).flat());return M.filter((function(n){return e.has(n)}))}),[M,F]),Q=o.useMemo((function(){var e=new Set(W.filter((function(e){return q.has(e)})));return B.filter((function(n){var t=n.repoAddress,r=n.scheduleName;return e.has((0,at.g)(t,r))}))}),[W,B,q]),J=M.length>0,H=Q.length;return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(f.m,{title:(0,C.jsx)(p.X6,{children:"Overview"}),tabs:(0,C.jsx)(A,{tab:"schedules",refreshState:N})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,C.jsxs)(x.x,{flex:{direction:"row",gap:12},children:[j,(0,C.jsx)(ve.oi,{icon:"search",value:a,onChange:function(e){l(e.target.value),$(!1)},placeholder:"Filter by schedule name\u2026",style:{width:"340px"}})]}),(0,C.jsx)(vn.u,{content:"You do not have permission to start or stop these schedules",canShow:z&&!J,placement:"top-end",useDisabledButtonTooltipFix:!0,children:(0,C.jsx)(it._,{schedules:Q,onDone:function(){return N.refetch()}})})]}),k.length?(0,C.jsx)(x.x,{padding:{vertical:8,horizontal:24},border:{side:"horizontal",width:1,color:U.w.KeylineGray},flex:{direction:"row",gap:8},children:k}):null,T&&!r?(0,C.jsx)(x.x,{padding:64,children:(0,C.jsx)(Z.$,{purpose:"page"})}):(0,C.jsxs)(C.Fragment,{children:["InstigationStates"===(null===E||void 0===E?void 0:E.unloadableInstigationStatesOrError.__typename)?(0,C.jsx)(vt,{count:E.unloadableInstigationStatesOrError.results.length}):null,(0,C.jsx)(ot.K,{daemonHealth:null===E||void 0===E?void 0:E.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:U.w.KeylineGray}}),function(){if(T&&!E)return(0,C.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,C.jsx)(Z.$,{purpose:"body-text"}),(0,C.jsx)("div",{style:{color:U.w.Gray600},children:"Loading schedules\u2026"})]})});var e=n.length>t.length;return F.length?(0,C.jsx)(xt,{headerCheckbox:J?(0,C.jsx)(lt.W,{checkedCount:H,totalCount:W.length,onToggleAll:$}):void 0,repos:F,checkedKeys:q,onToggleCheckFactory:G}):P?(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(g.t,{icon:"search",title:"No matching schedules",description:e?(0,C.jsxs)("div",{children:["No schedules matching ",(0,C.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,C.jsxs)("div",{children:["No schedules matching ",(0,C.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(g.t,{icon:"search",title:"No schedules",description:e?"No matching schedules were found in the selected code locations":"No matching schedules were found in your definitions"})})}()]})]})},vt=function(e){var n=e.count,t=o.useState(!1),r=(0,_.Z)(t,2),s=r[0],i=r[1];if(!n)return null;var a=1===n?"1 unloadable schedule":"".concat(n," unloadable schedules");return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.x,{padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:U.w.KeylineGray},children:(0,C.jsx)(Zn.b,{intent:"warning",title:a,description:(0,C.jsxs)(x.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,C.jsx)("div",{children:"Schedules were previously started but now cannot be loaded. They may be part of a code locations that no longer exist. You can turn them off, but you cannot turn them back on."}),(0,C.jsx)(V.zx,{onClick:function(){return i(!0)},children:1===n?"View unloadable schedule":"View unloadable schedules"})]})})}),(0,C.jsxs)(D.Vq,{isOpen:s,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,C.jsx)(x.x,{padding:{bottom:8},children:(0,C.jsx)(jt,{})}),(0,C.jsx)(D.cN,{children:(0,C.jsx)(V.zx,{intent:"primary",onClick:function(){return i(!1)},children:"Done"})})]})]})},jt=function(){var e=(0,d.a)(bt).data;return e?"InstigationStates"===(null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError.__typename)?(0,C.jsx)(Xn,{scheduleStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,C.jsx)(j.T9,{error:null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError}):(0,C.jsx)(Z.$,{purpose:"section"})},yt=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,t=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),r=[],s=(0,rn.Z)(t);try{for(s.s();!(n=s.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var o,a=(0,rn.Z)(i.repositories);try{for(a.s();!(o=a.n()).done;){var l=o.value,c=l.name,d=l.schedules,u=(0,Oe.kQ)(c,i.name),h=d.map((function(e){return{name:e.name,scheduleState:e.scheduleState}}));h.length>0&&r.push({repoAddress:u,schedules:h})}}catch(f){a.e(f)}finally{a.f()}}}}catch(f){s.e(f)}finally{s.f()}return Cn(r)},wt=(0,u.Ps)(Ge||(Ge=(0,l.Z)(["\n  query OverviewSchedulesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                schedules {\n                  id\n                  name\n                  description\n                  scheduleState {\n                    id\n                    ...BasicInstigationStateFragment\n                  }\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"])),ft.i,v.B,O.O),bt=(0,u.Ps)($e||($e=(0,l.Z)(["\n  query UnloadableSchedulesQuery {\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),Bn.ai,v.B),kt=t(20460),St=t(75428),Ct=t(93548),At=t(4116),Et=function(e){var n=e.repos,t=e.headerCheckbox,r=e.checkedKeys,s=e.onToggleCheckFactory,i=o.useRef(null),a=o.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,an.Uz)(n)}))}),[n]),l=(0,yn.N)(kn.y,a),c=l.expandedKeys,d=l.onToggle,u=l.onToggleAll,h=o.useMemo((function(){var e=[];return n.forEach((function(n){var t=n.repoAddress,r=n.sensors;e.push({type:"header",repoAddress:t,sensorCount:r.length});var s=(0,an.Uz)(t);c.includes(s)&&r.forEach((function(n){e.push({type:"sensor",repoAddress:t,sensor:n})}))})),e}),[n,c]),f=(0,jn.w)(n.map((function(e){return e.repoAddress.name}))),p=(0,ke.useVirtualizer)({count:h.length,getScrollElement:function(){return i.current},estimateSize:function(e){var n=h[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),x=p.getTotalSize(),g=p.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(At.K,{checkbox:t}),(0,C.jsx)("div",{style:{overflow:"hidden"},children:(0,C.jsx)(Ie.W2,{ref:i,children:(0,C.jsx)(Ie.Nh,{$totalHeight:x,children:g.map((function(e){var n=e.index,i=e.key,o=e.size,a=e.start,l=h[n];if("header"===l.type)return(0,C.jsx)(bn.vG,{repoAddress:l.repoAddress,height:o,start:a,onToggle:d,onToggleAll:u,expanded:c.includes((0,an.Uz)(l.repoAddress)),showLocation:f.has(l.repoAddress.name),rightElement:(0,C.jsx)(vn.u,{content:1===l.sensorCount?"1 sensor":"".concat(l.sensorCount," sensors"),placement:"top",children:(0,C.jsx)(B.V,{children:l.sensorCount})})},i);var p=(0,Ct.x)(l.repoAddress,l.sensor.name);return(0,C.jsx)(At.R,{name:l.sensor.name,sensorState:l.sensor.sensorState,showCheckboxColumn:!!t,checked:r.has(p),onToggleChecked:s(p),repoAddress:l.repoAddress,height:o,start:a},i)}))})})})]})},Tt=["sensors"],Nt=function(){(0,w.Px)(),(0,b.j)("Overview | Sensors");var e=o.useContext(fn.C5),n=e.allRepos,t=e.visibleRepos,r=n.length,s=(0,Te.q)({queryKey:"search",defaults:{search:""}}),i=(0,_.Z)(s,2),a=i[0],l=i[1],u=ut(),h=(0,ht.g)(),m=o.useMemo((function(){return[u,h]}),[u,h]),v=(0,ct.m)({filters:m}),j=v.button,k=v.activeFiltersJsx,S=(0,d.a)(Lt,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),E=S.data,T=S.loading,N=(0,y.C4)(S,y.dT),I=o.useMemo((function(){var e=An(t);return Rt(E).filter((function(n){var t=n.repoAddress;return e.has((0,an.Uz)(t))}))}),[E,t]),O=h.state,R=o.useMemo((function(){return I.map((function(e){var n=e.sensors,t=(0,Fn.Z)(e,Tt);return(0,c.Z)((0,c.Z)({},t),{},{sensors:O.size?n.filter((function(e){var n=e.sensorState;return O.has(n.status)})):n})}))}),[I,O]),L=a.trim().toLocaleLowerCase(),P=L.length>0,F=o.useMemo((function(){var e=L.toLocaleLowerCase();return R.map((function(n){return{repoAddress:n.repoAddress,sensors:n.sensors.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.sensors.length>0}))}),[R,L]),z=o.useMemo((function(){return F.some((function(e){return e.sensors.length>0}))}),[F]),B=o.useMemo((function(){return I.map((function(e){var n=e.repoAddress;return e.sensors.filter((function(e){var n=e.sensorState;return(0,st.i)(n)})).map((function(e){var t=e.name,r=e.sensorState;return{repoAddress:n,sensorName:t,sensorState:r}}))})).flat()}),[I]),M=o.useMemo((function(){return B.map((function(e){var n=e.repoAddress,t=e.sensorName;return(0,Ct.x)(n,t)}))}),[B]),D=(0,zn.a)(M),V=(0,_.Z)(D,2),q=V[0].checkedIds,K=V[1],G=K.onToggleFactory,$=K.onToggleAll,W=o.useMemo((function(){var e=new Set(F.map((function(e){var n=e.repoAddress;return e.sensors.map((function(e){var t=e.name;return(0,Ct.x)(n,t)}))})).flat());return M.filter((function(n){return e.has(n)}))}),[M,F]),Q=o.useMemo((function(){var e=new Set(W.filter((function(e){return q.has(e)})));return B.filter((function(n){var t=n.repoAddress,r=n.sensorName;return e.has((0,Ct.x)(t,r))}))}),[W,B,q]),J=M.length>0,H=Q.length;return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(f.m,{title:(0,C.jsx)(p.X6,{children:"Overview"}),tabs:(0,C.jsx)(A,{tab:"sensors",refreshState:N})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",gap:12,grow:0},children:[(0,C.jsxs)(x.x,{flex:{direction:"row",gap:12},children:[j,(0,C.jsx)(ve.oi,{icon:"search",value:a,onChange:function(e){return l(e.target.value)},placeholder:"Filter by sensor name\u2026",style:{width:"340px"}})]}),(0,C.jsx)(vn.u,{content:"You do not have permission to start or stop these schedules",canShow:z&&!J,placement:"top-end",useDisabledButtonTooltipFix:!0,children:(0,C.jsx)(kt.b,{sensors:Q,onDone:function(){return N.refetch()}})})]}),k.length?(0,C.jsx)(x.x,{padding:{vertical:8,horizontal:24},border:{side:"horizontal",width:1,color:U.w.KeylineGray},flex:{direction:"row",gap:8},children:k}):null,T&&!r?(0,C.jsx)(x.x,{padding:64,children:(0,C.jsx)(Z.$,{purpose:"page"})}):(0,C.jsxs)(C.Fragment,{children:["InstigationStates"===(null===E||void 0===E?void 0:E.unloadableInstigationStatesOrError.__typename)?(0,C.jsx)(It,{count:E.unloadableInstigationStatesOrError.results.length}):null,(0,C.jsx)(St.F,{daemonHealth:null===E||void 0===E?void 0:E.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:U.w.KeylineGray}}),function(){if(T&&!E)return(0,C.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,C.jsx)(Z.$,{purpose:"body-text"}),(0,C.jsx)("div",{style:{color:U.w.Gray600},children:"Loading sensors\u2026"})]})});var e=n.length>t.length;return F.length?(0,C.jsx)(Et,{headerCheckbox:J?(0,C.jsx)(lt.W,{checkedCount:H,totalCount:W.length,onToggleAll:$}):void 0,repos:F,checkedKeys:q,onToggleCheckFactory:G}):P?(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(g.t,{icon:"search",title:"No matching sensors",description:e?(0,C.jsxs)("div",{children:["No sensors matching ",(0,C.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,C.jsxs)("div",{children:["No sensors matching ",(0,C.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(g.t,{icon:"search",title:"No sensors",description:e?"No sensors were found in the selected code locations":"No sensors were found in your definitions"})})}()]})]})},It=function(e){var n=e.count,t=o.useState(!1),r=(0,_.Z)(t,2),s=r[0],i=r[1];if(!n)return null;var a=1===n?"1 unloadable sensor":"".concat(n," unloadable sensors");return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.x,{padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:U.w.KeylineGray},children:(0,C.jsx)(Zn.b,{intent:"warning",title:a,description:(0,C.jsxs)(x.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,C.jsx)("div",{children:"Sensors were previously started but now cannot be loaded. They may be part of a code location that no longer exists. You can turn them off, but you cannot turn them back on."}),(0,C.jsx)(V.zx,{onClick:function(){return i(!0)},children:1===n?"View unloadable sensor":"View unloadable sensors"})]})})}),(0,C.jsxs)(D.Vq,{isOpen:s,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,C.jsx)(x.x,{padding:{bottom:8},children:(0,C.jsx)(Ot,{})}),(0,C.jsx)(D.cN,{children:(0,C.jsx)(V.zx,{intent:"primary",onClick:function(){return i(!1)},children:"Done"})})]})]})},Ot=function(){var e=(0,d.a)(Pt).data;return e?"InstigationStates"===(null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError.__typename)?(0,C.jsx)(Yn,{sensorStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,C.jsx)(j.T9,{error:null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError}):(0,C.jsx)(Z.$,{purpose:"section"})},Rt=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,t=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),r=[],s=(0,rn.Z)(t);try{for(s.s();!(n=s.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var o,a=(0,rn.Z)(i.repositories);try{for(a.s();!(o=a.n()).done;){var l=o.value,c=l.name,d=l.sensors,u=(0,Oe.kQ)(c,i.name);d.length>0&&r.push({repoAddress:u,sensors:d})}}catch(h){a.e(h)}finally{a.f()}}}}catch(h){s.e(h)}finally{s.f()}return Cn(r)},Lt=(0,u.Ps)(We||(We=(0,l.Z)(["\n  query OverviewSensorsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                sensors {\n                  id\n                  name\n                  description\n                  sensorType\n                  sensorState {\n                    id\n                    ...BasicInstigationStateFragment\n                  }\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"])),ft.i,v.B,O.O),Pt=(0,u.Ps)(Qe||(Qe=(0,l.Z)(["\n  query UnloadableSensorsQuery {\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),Bn.ai,v.B),_t=function(){return(0,C.jsxs)(a.rs,{children:[(0,C.jsx)(a.AW,{path:"/overview/activity",children:(0,C.jsx)(mn,{})}),(0,C.jsx)(a.AW,{path:"/overview/jobs",children:(0,C.jsx)(En,{})}),(0,C.jsx)(a.AW,{path:"/overview/schedules",children:(0,C.jsx)(mt,{})}),(0,C.jsx)(a.AW,{path:"/overview/sensors",children:(0,C.jsx)(Nt,{})}),(0,C.jsx)(a.AW,{path:"/overview/backfills/:backfillId",children:(0,C.jsx)(oe,{})}),(0,C.jsx)(a.AW,{path:"/overview/backfills",exact:!0,children:(0,C.jsx)(R,{})}),(0,C.jsx)(a.AW,{path:"/overview/resources",children:(0,C.jsx)(Ln,{})}),(0,C.jsx)(a.AW,{path:"*",render:function(){return(0,C.jsx)(a.l_,{to:"/overview/activity"})}})]})},Ft=_t},94232:function(e,n,t){t.d(n,{Q1:function(){return k},Qf:function(){return S},zc:function(){return b}});var r,s=t(71171),i=t(68079),o=t(96234),a=t(33028),l=t(60319),c=t(90239),d=t(31623),u=t(45519),h=t(32667),f=t(8236),p=t.n(f),x=t(78193),g=t(50032),m=t(67099),v=t(85279),j=t(20967),y=t(95904),w=t(35936),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,c.a)(C,{variables:{queuedFilter:(0,a.Z)((0,a.Z)({},e),{},{statuses:Array.from(j.sy)}),inProgressFilter:(0,a.Z)((0,a.Z)({},e),{},{statuses:Array.from(j.Ys)})}}),t=n.data,r=x.useMemo((function(){var e,n;return{queuedCount:"Runs"===(null===t||void 0===t||null===(e=t.queuedCount)||void 0===e?void 0:e.__typename)?t.queuedCount.count:null,inProgressCount:"Runs"===(null===t||void 0===t||null===(n=t.inProgressCount)||void 0===n?void 0:n.__typename)?t.inProgressCount.count:null}}),[t]),s=r.queuedCount,l=r.inProgressCount,d=(0,y.oD)(),h=(0,o.Z)(d,1)[0],f=S(h);(0,m.j)(function(e){switch(e){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}}(f));var p=function(e){var n=h.filter((function(e){return"status"!==e.token})),t=e.map((function(e){return{token:"status",value:e}}));return(0,y.it)([].concat((0,i.Z)(t),(0,i.Z)(n)))};return{tabs:(0,w.jsxs)(u.zH,{children:[(0,w.jsx)(k,{to:p([]),id:"all",$active:"all"===f,children:"All runs"}),(0,w.jsxs)(k,{to:p(Array.from(j.sy)),id:"queued",$active:"queued"===f,children:["Queued (",null!==s&&void 0!==s?s:"indeterminate",")"]}),(0,w.jsxs)(k,{to:p(Array.from(j.Ys)),id:"in-progress",$active:"in-progress"===f,children:["In progress (",null!==l&&void 0!==l?l:"indeterminate",")"]}),(0,w.jsx)(k,{to:p(Array.from(j.hd)),id:"failed",$active:"failed"===f,children:"Failed"}),(0,w.jsx)(k,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===f,children:"Scheduled"})]}),queryResult:n}},k=(0,l.ZP)(v.A).withConfig({displayName:"RunListTabs__ActivatableButton",componentId:"sc-l84x0v-0"})(["",""],(function(e){return e.$active&&"\n    background: ".concat(h.w.Gray200,";\n  ")})),S=function(e){var n=(0,g.TH)().pathname;if("/runs/timeline"===n)return"timeline";if("/runs/scheduled"===n)return"scheduled";if("/overview/backfills"===n)return"backfills";var t=new Set(e.filter((function(e){return"status"===e.token})).map((function(e){return e.value})));return p()(j.sy,t)?"queued":p()(j.Ys,t)?"in-progress":p()(j.hd,t)?"failed":"all"},C=(0,d.Ps)(r||(r=(0,s.Z)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"])))}}]);
//# sourceMappingURL=619.95405f21.chunk.js.map
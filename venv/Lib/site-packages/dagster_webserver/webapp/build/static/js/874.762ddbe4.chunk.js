"use strict";(self.webpackChunk_dagster_io_dagit_app=self.webpackChunk_dagster_io_dagit_app||[]).push([[874],{75418:function(e,n,t){t.d(n,{a:function(){return a}});var o,r=t(71171),i=t(90239),s=t(31623),a=function(){var e=(0,i.a)(l).data;return!(null===e||void 0===e||!e.instance.hasCapturedLogManager)},l=(0,s.Ps)(o||(o=(0,r.Z)(["\n  query InstanceSupportsCapturedLogs {\n    instance {\n      id\n      hasCapturedLogManager\n    }\n  }\n"])))},68365:function(e,n,t){t.d(n,{h:function(){return b}});var o,r,i,s=t(96234),a=t(71171),l=t(33028),u=t(59740),c=t(78912),d=t(31623),p=t(90239),g=t(47515),f=t(32667),h=t(61623),m=t(78193),v=t(33418),y=t(23142),x=t(17471),w=t(35936),C=["logCaptureInfo"],b=m.memo((function(e){var n=e.logCaptureInfo,t=(0,u.Z)(e,C),o=n&&("stdout"===t.visibleIOType?n.externalStdoutUrl:n.externalStderrUrl);return o?(0,w.jsxs)(g.x,{flex:{direction:"row",alignItems:"center",justifyContent:"center",gap:1},background:f.w.Gray900,style:{color:f.w.White,flex:1,minHeight:0},children:["View logs at",(0,w.jsx)("a",{href:o,target:"_blank",rel:"noreferrer",style:{color:f.w.White,textDecoration:"underline",marginLeft:4,marginRight:4},children:o}),(0,w.jsx)(h.JO,{name:"open_in_new",color:f.w.White,size:20,style:{marginTop:2}})]}):t.logKey.length?(0,w.jsx)(K,(0,l.Z)({},t)):null})),j=5242880,L=function(e){return e.length<j?e:e.slice(-5242880)},S=function(e,n){return n?L(e?e+n:n):e||null},Z=function(e,n){var t,o,r;switch(n.type){case"update":return(0,l.Z)((0,l.Z)({},e),{},{isLoading:!1,cursor:null===(t=n.logData)||void 0===t?void 0:t.cursor,stdout:S(e.stdout,null===(o=n.logData)||void 0===o?void 0:o.stdout),stderr:S(e.stderr,null===(r=n.logData)||void 0===r?void 0:r.stderr)});case"metadata":return(0,l.Z)((0,l.Z)({},e),n.metadata);case"reset":return(0,l.Z)({},I);default:return e}},I={stdout:null,stderr:null,cursor:null,isLoading:!0},R=m.memo((function(e){var n=e.logKey,t=e.onLogData;return(0,c.m)(N,{fetchPolicy:"no-cache",variables:{logKey:n},onSubscriptionData:function(e){var n,o=e.subscriptionData;null!==(n=o.data)&&void 0!==n&&n.capturedLogs&&t(o.data.capturedLogs)}}),null})),N=(0,d.Ps)(o||(o=(0,a.Z)(["\n  subscription CapturedLogsSubscription($logKey: [String!]!, $cursor: String) {\n    capturedLogs(logKey: $logKey, cursor: $cursor) {\n      ...CapturedLog\n    }\n  }\n\n  fragment CapturedLog on CapturedLogs {\n    stdout\n    stderr\n    cursor\n  }\n"]))),E=(0,d.Ps)(r||(r=(0,a.Z)(["\n  query CapturedLogsMetadataQuery($logKey: [String!]!) {\n    capturedLogsMetadata(logKey: $logKey) {\n      stdoutDownloadUrl\n      stdoutLocation\n      stderrDownloadUrl\n      stderrLocation\n    }\n  }\n"]))),T=function(e){var n=e.logKey,t=e.children,o=m.useReducer(Z,I),r=(0,s.Z)(o,2),i=r[0],a=r[1],l=JSON.stringify(n);m.useEffect((function(){a({type:"reset"})}),[l]);var u=m.useCallback((function(e){a({type:"update",logData:e})}),[]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(R,{logKey:n,onLogData:u}),t(i)]})},k=function(e){var n=e.logKey,t=e.children,o=m.useReducer(Z,I),r=(0,s.Z)(o,2),i=r[0],a=r[1],l=JSON.stringify(n);m.useEffect((function(){a({type:"reset"})}),[l]);var u=i.cursor,c=(0,p.a)(D,{notifyOnNetworkStatusChange:!0,variables:{logKey:n,cursor:u,limit:1e5},pollInterval:5e3,onCompleted:function(e){d(),a({type:"update",logData:e.capturedLogs}),g(5e3)}}),d=c.stopPolling,g=c.startPolling;return(0,w.jsx)(w.Fragment,{children:t(i)})},D=(0,d.Ps)(i||(i=(0,a.Z)(["\n  query CapturedLogsQuery($logKey: [String!]!, $cursor: String, $limit: Int) {\n    capturedLogs(logKey: $logKey, cursor: $cursor, limit: $limit) {\n      stdout\n      stderr\n      cursor\n    }\n  }\n"]))),K=m.memo((function(e){var n,t,o=e.logKey,r=e.visibleIOType,i=e.onSetDownloadUrl,s=m.useContext(v.I).rootServerURI,a=m.useContext(y.DN),l=a.availability,u=a.disabled,c=(0,p.a)(E,{variables:{logKey:o}});m.useEffect((function(){if(i&&c.data){var e="stdout"===r?c.data.capturedLogsMetadata.stdoutDownloadUrl:c.data.capturedLogsMetadata.stderrDownloadUrl;e&&(e.startsWith("/")?i(s+e):i(e))}}),[i,r,s,c.data]);var d=(null===(n=c.data)||void 0===n?void 0:n.capturedLogsMetadata.stdoutLocation)||void 0,g=(null===(t=c.data)||void 0===t?void 0:t.capturedLogsMetadata.stderrLocation)||void 0,f="unavailable"===l||u?k:T;return(0,w.jsx)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:(0,w.jsx)(f,{logKey:o,children:function(e){return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(x.o,{logData:e.stdout,isLoading:e.isLoading,location:d,isVisible:"stdout"===r}),(0,w.jsx)(x.o,{logData:e.stderr,isLoading:e.isLoading,location:g,isVisible:"stderr"===r})]})}})})}))},33657:function(e,n,t){t.d(n,{K:function(){return b}});var o,r=t(47515),i=t(62459),s=t(78193),a=t(33418),l=t(17471),u=t(71171),c=t(96234),d=t(33028),p=t(78912),g=t(31623),f=t(23555),h=5242880,m=function(e){return e.length<h?e:e.slice(-5242880)},v=function(e,n){if(!n)return e;var t=null===e||void 0===e?void 0:e.data;return null!==e&&void 0!==e&&e.data&&null!==n&&void 0!==n&&n.data?t=m(e.data+n.data):null!==n&&void 0!==n&&n.data&&(t=m(n.data)),{__typename:n.__typename,path:n.path,downloadUrl:n.downloadUrl,data:"string"===typeof t?t:null,cursor:n.cursor}},y=function(e,n){switch(n.type){case"stdout":var t=n.stepKey===e.stepKey?v(e.stdout,n.log):n.log;return(0,d.Z)((0,d.Z)({},e),{},{isLoading:!1,stdout:t});case"stderr":var o=n.stepKey===e.stepKey?v(e.stderr,n.log):n.log;return(0,d.Z)((0,d.Z)({},e),{},{isLoading:!1,stderr:o});default:return e}},x={stepKey:"",stdout:null,stderr:null,isLoading:!0},w=(0,g.Ps)(o||(o=(0,u.Z)(["\n  subscription ComputeLogsSubscription(\n    $runId: ID!\n    $stepKey: String!\n    $ioType: ComputeIOType!\n    $cursor: String\n  ) {\n    computeLogs(runId: $runId, stepKey: $stepKey, ioType: $ioType, cursor: $cursor) {\n      ...ComputeLogForSubscription\n    }\n  }\n\n  fragment ComputeLogForSubscription on ComputeLogFile {\n    path\n    cursor\n    data\n    downloadUrl\n  }\n"]))),C=t(35936),b=function(e){var n=e.runId,t=e.computeLogFileKey,o=e.ioType,s=e.setComputeLogUrl;return t?(0,C.jsx)(L,{runId:n,computeLogFileKey:t,ioType:o,setComputeLogUrl:s}):(0,C.jsx)(r.x,{flex:{justifyContent:"center",alignItems:"center"},style:{flex:1,height:"100%"},children:(0,C.jsx)(i.$,{purpose:"section"})})},j=function(e,n){if(!n)return null;var t;return(t=n)&&t.startsWith("/")?e+n:n},L=s.memo((function(e){var n=e.runId,t=e.computeLogFileKey,o=e.ioType,r=e.setComputeLogUrl,i=s.useContext(a.I).rootServerURI,l=function(e,n){var t=s.useReducer(y,x),o=(0,c.Z)(t,2),r=o[0],i=o[1];return(0,p.m)(w,{fetchPolicy:"no-cache",variables:{runId:e,stepKey:n,ioType:f.E90.STDOUT,cursor:null},onSubscriptionData:function(e){var t,o=e.subscriptionData;i({type:"stdout",stepKey:n,log:(null===(t=o.data)||void 0===t?void 0:t.computeLogs)||null})}}),(0,p.m)(w,{fetchPolicy:"no-cache",variables:{runId:e,stepKey:n,ioType:f.E90.STDERR,cursor:null},onSubscriptionData:function(e){var t,o=e.subscriptionData;i({type:"stderr",stepKey:n,log:(null===(t=o.data)||void 0===t?void 0:t.computeLogs)||null})}}),r}(n,t),u=l.isLoading,d=l.stdout,g=l.stderr,h=j(i,(null===d||void 0===d?void 0:d.downloadUrl)||null),m=j(i,(null===g||void 0===g?void 0:g.downloadUrl)||null);return(0,C.jsxs)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[(0,C.jsx)(S,{content:d?d.data:null,path:d?d.path:void 0,downloadUrl:h,isLoading:u,isVisible:"stdout"===o,setComputeLogUrl:r}),(0,C.jsx)(S,{content:g?g.data:null,path:g?g.path:void 0,downloadUrl:m,isLoading:u,isVisible:"stderr"===o,setComputeLogUrl:r})]})})),S=function(e){var n=e.isLoading,t=e.isVisible,o=e.content,r=e.path,i=e.downloadUrl,a=e.setComputeLogUrl;return s.useEffect((function(){a(i)}),[a,i]),(0,C.jsx)(l.o,{logData:o,isLoading:n,isVisible:t,downloadUrl:i,location:r})}},26390:function(e,n,t){t.d(n,{C:function(){return E}});var o,r,i,s=t(71171),a=t(96234),l=t(33028),u=t(41361),c=t(68079),d=t(61794),p=t(78912),g=t(90239),f=t(31623),h=t(47317),m=t.n(h),v=t(78193),y=t(23142),x=t(23555),w=t(42236),C=t(75302),b=t(35936),j={DEBUG:0,INFO:0,WARNING:0,ERROR:0,CRITICAL:0,EVENT:0},L=function(e,n){switch(n.type){case"append":var t=n.queued.map((function(e,n){return(0,l.Z)((0,l.Z)({},e),{},{clientsideKey:"csk".concat(e.timestamp,"-").concat(n)})})),o=[].concat((0,c.Z)(e.nodes),(0,c.Z)(t)),r=(0,l.Z)({},e.counts);return t.forEach((function(e){var n=(0,C.m)(e);r[n]++})),{nodes:o,counts:r,loading:n.hasMore,cursor:n.cursor};case"set-cursor":return(0,l.Z)((0,l.Z)({},e),{},{cursor:n.cursor});case"reset":return{nodes:[],counts:j,cursor:null,loading:!0};default:return e}},S={nodes:[],counts:j,cursor:null,loading:!0},Z=function(e){var n=(0,d.x)(),t=v.useRef([]),o=v.useReducer(L,S),r=(0,a.Z)(o,2),i=r[0],s=r[1],p=v.useCallback((function(t){var o=n.readFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:k,id:"Run:".concat(e)});if(o){var r=(0,l.Z)((0,l.Z)({},o),{},{canTerminate:t===x.VOA.QUEUED||t===x.VOA.STARTED,status:t});n.writeFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:k,id:"Run:".concat(e),data:r})}}),[n,e]);v.useEffect((function(){t.current=[],s({type:"reset"})}),[e]);var g=v.useMemo((function(){return m()((function(){if(t.current.length){var e=(0,c.Z)(t.current);t.current=[];var n=e.flatMap((function(e){return e.messages})),o=e[e.length-1],r=o.hasMorePastEvents,i=o.cursor;s({type:"append",queued:n,hasMore:r,cursor:i});var a=function(e){var n,t=(0,c.Z)(e).reverse(),o=(0,u.Z)(t);try{for(o.s();!(n=o.n()).done;)switch(n.value.__typename){case"RunStartEvent":return x.VOA.STARTED;case"RunEnqueuedEvent":return x.VOA.QUEUED;case"RunStartingEvent":return x.VOA.STARTING;case"RunCancelingEvent":return x.VOA.CANCELING;case"RunCanceledEvent":return x.VOA.CANCELED;case"RunSuccessEvent":return x.VOA.SUCCESS;case"RunFailureEvent":return x.VOA.FAILURE}}catch(r){o.e(r)}finally{o.f()}return null}(n);a&&!r&&p(a)}}),100)}),[p]),f=i.nodes,h=i.counts,w=i.cursor,C=i.loading,j=v.useContext(y.DN),Z=j.availability,R=j.disabled,N=j.status,E=!R&&"available"===Z&&N===WebSocket.CLOSED,T=v.useRef(w);E&&(T.current=w);var D=T.current,K=v.useMemo((function(){return{runId:e,cursor:D}}),[e,D]),_=v.useMemo((function(){return(0,b.jsx)(I,{variables:K,onSubscriptionData:function(e){var n,o=null===(n=e.subscriptionData.data)||void 0===n?void 0:n.pipelineRunLogs;o&&"PipelineRunLogsSubscriptionFailure"!==o.__typename&&(t.current.push(o),requestAnimationFrame(g))}})}),[K,g]);return v.useMemo((function(){return null!==f?{allNodes:f,counts:h,loading:C,subscriptionComponent:_}:{allNodes:[],counts:h,loading:C,subscriptionComponent:_}}),[h,C,f,_])},I=function(e){var n=e.variables,t=e.onSubscriptionData;return(0,p.m)(T,{fetchPolicy:"no-cache",variables:n,onSubscriptionData:t}),null},R=function(e){var n=Z(e.runId);return(0,b.jsxs)(b.Fragment,{children:[n.subscriptionComponent,e.children(n)]})},N=function(e){var n=e.children,t=e.runId,o=v.useReducer(L,S),r=(0,a.Z)(o,2),i=r[0],s=r[1],l=i.counts,u=i.cursor,c=i.nodes,d=(0,g.a)(D,{notifyOnNetworkStatusChange:!0,variables:{runId:t,cursor:u,limit:1e4},pollInterval:5e3,onCompleted:function(e){if(p(),"Run"===(null===e||void 0===e?void 0:e.pipelineRunOrError.__typename)&&"EventConnection"===(null===e||void 0===e?void 0:e.logsForRun.__typename)){var n=e.pipelineRunOrError,t=e.logsForRun.events,o=n.status,r=e.logsForRun.cursor,i=!!o&&o!==x.VOA.FAILURE&&o!==x.VOA.SUCCESS&&o!==x.VOA.CANCELED;s({type:"append",queued:t,hasMore:i,cursor:r}),i&&f(5e3)}}}),p=d.stopPolling,f=d.startPolling;return(0,b.jsx)(b.Fragment,{children:n(null!==c&&c.length>0?{allNodes:c,counts:l,loading:!1}:{allNodes:[],counts:l,loading:!0})})},E=function(e){var n=e.children,t=e.runId,o=v.useContext(y.DN),r=o.availability,i=o.disabled;return"unavailable"===r||i?(0,b.jsx)(N,{runId:t,children:n}):"attempting-to-connect"===r?(0,b.jsx)(b.Fragment,{children:n({allNodes:[],counts:j,loading:!0})}):(0,b.jsx)(R,{runId:t,children:n})},T=(0,f.Ps)(o||(o=(0,s.Z)(["\n  subscription PipelineRunLogsSubscription($runId: ID!, $cursor: String) {\n    pipelineRunLogs(runId: $runId, cursor: $cursor) {\n      ... on PipelineRunLogsSubscriptionFailure {\n        missingRunId\n        message\n      }\n      ...RunLogsSubscriptionSuccess\n    }\n  }\n\n  fragment RunLogsSubscriptionSuccess on PipelineRunLogsSubscriptionSuccess {\n    messages {\n      ... on MessageEvent {\n        runId\n      }\n      ...RunDagsterRunEventFragment\n    }\n    hasMorePastEvents\n    cursor\n  }\n\n  ","\n"])),w.$K),k=(0,f.Ps)(r||(r=(0,s.Z)(["\n  fragment PipelineRunLogsSubscriptionStatusFragment on Run {\n    id\n    status\n    canTerminate\n  }\n"]))),D=(0,f.Ps)(i||(i=(0,s.Z)(["\n  query RunLogsQuery($runId: ID!, $cursor: String, $limit: Int) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        canTerminate\n      }\n    }\n    logsForRun(runId: $runId, afterCursor: $cursor, limit: $limit) {\n      ... on EventConnection {\n        events {\n          ... on MessageEvent {\n            runId\n          }\n          ...RunDagsterRunEventFragment\n        }\n        cursor\n      }\n      ... on PythonError {\n        message\n        stack\n      }\n    }\n  }\n\n  ","\n"])),w.$K)},90039:function(e,n,t){t.d(n,{hi:function(){return q},KZ:function(){return V}});var o=t(56666),r=t(33028),i=t(96234),s=t(60319),a=t(47515),l=t(21189),u=t(33290),c=t(85357),d=t(45519),p=t(61623),g=t(44229),f=t(62459),h=t(32667),m=t(17914),v=t(78193),y=t(22260),x=t(50319),w=t(79962),C=t(90986),b=s.ZP.div.withConfig({displayName:"ExecutionStateDot",componentId:"sc-1e4maq3-0"})(["display:inline-block;width:11px;height:11px;border-radius:5.5px;transition:background 200ms linear;background:",";&:hover{background:",";}"],(function(e){var n,t=e.state;return(n={},(0,o.Z)(n,C.TN.RUNNING,h.w.Gray400),(0,o.Z)(n,C.TN.SUCCEEDED,h.w.Green700),(0,o.Z)(n,C.TN.SKIPPED,h.w.Yellow500),(0,o.Z)(n,C.TN.FAILED,h.w.Red500),(0,o.Z)(n,C.TN.PREPARING,h.w.Red500),(0,o.Z)(n,C.TN.RETRY_REQUESTED,h.w.Red500),(0,o.Z)(n,C.TN.UNKNOWN,h.w.Red500),n)[t]}),(function(e){var n,t=e.state;return(n={},(0,o.Z)(n,C.TN.RUNNING,h.w.Gray400),(0,o.Z)(n,C.TN.SUCCEEDED,h.w.Green700),(0,o.Z)(n,C.TN.SKIPPED,h.w.Yellow500),(0,o.Z)(n,C.TN.FAILED,h.w.Red200),(0,o.Z)(n,C.TN.PREPARING,h.w.Red500),(0,o.Z)(n,C.TN.RETRY_REQUESTED,h.w.Red500),(0,o.Z)(n,C.TN.UNKNOWN,h.w.Red500),n)[t]})),j=t(73070),L=t(25960),S=t(35936),Z=function(e){var n=e.options,t=e.onSetFilter,o=v.useState(!1),r=(0,i.Z)(o,2),s=r[0],l=r[1],u=Object.keys(n),d=Object.values(n).reduce((function(e,n){return n.enabled?e+1:e}),0),g=function(e){return function(n){var o=n.target.checked;t(e,o)}};return(0,S.jsx)(j.J,{isOpen:s,placement:"bottom-start",canEscapeKeyClose:!0,onInteraction:function(e){return l(e)},content:(0,S.jsx)(c.v2,{style:{width:"180px"},"aria-label":"filter-options",children:u.map((function(e){var t=n[e],o=t.label,r=t.count,i=t.enabled;return(0,S.jsx)(c.sN,{tagName:"div",shouldDismissPopover:!1,text:(0,S.jsx)(a.x,{flex:{direction:"row",alignItems:"center"},children:(0,S.jsx)(R,{id:"menu-check-".concat(e),checked:i,onChange:g(e),label:(0,S.jsxs)(a.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"center"},style:{flex:1},children:[(0,S.jsx)("div",{children:o}),(0,S.jsx)("div",{style:{color:h.w.Gray500},children:(0,L.J)(r)})]})})})},e)}))}),children:(0,S.jsxs)(I,{onClick:function(){return l((function(e){return!e}))},icon:(0,S.jsx)(p.JO,{name:"filter_alt"}),rightIcon:(0,S.jsx)(p.JO,{name:"expand_more"}),children:["Levels (",d,")"]})})},I=(0,s.ZP)(d.zx).withConfig({displayName:"LogFilterSelect__FilterButton",componentId:"sc-fb8dp1-0"})(["justify-content:space-between;width:100%;"]),R=(0,s.ZP)(m.X).withConfig({displayName:"LogFilterSelect__MenuCheckbox",componentId:"sc-fb8dp1-1"})(["display:flex;flex:1;"]),N=t(15998),E=t(80923),T=t(53984),k=t(79936),D=function(e,n){switch(n.type){case"show-popover":return(0,r.Z)((0,r.Z)({},e),{},{shown:!0});case"hide-popover":return(0,r.Z)((0,r.Z)({},e),{},{shown:!1});case"highlight":return(0,r.Z)((0,r.Z)({},e),{},{highlight:n.highlight});case"change-query":return(0,r.Z)((0,r.Z)({},e),{},{shown:!0,highlight:0});case"select-suggestion":return(0,r.Z)((0,r.Z)({},e),{},{highlight:0});default:return e}},K={shown:!1,highlight:0},_={threshold:.3},P=function(e){var n=e.value,t=e.onChange,s=e.suggestionProviders,a=v.useReducer(D,K),l=(0,i.Z)(a,2),u=l[0],c=l[1],d=u.shown,g=u.highlight,f=v.useRef(null),h=v.useMemo((function(){var e=s.reduce((function(e,n){var t=n.values();return n.token?(0,r.Z)((0,r.Z)({},e),{},(0,o.Z)({},n.token,{fuse:new T.Z(t,_),all:t})):e}),{}),n=s.map((function(e){return e.token})).filter((function(e){return e}));return{empty:new T.Z(n,_),perProvider:e}}),[s]),m=h.empty,y=h.perProvider,x=v.useCallback((function(e){if(!e)return Object.keys(y);var n=e.split(":"),t=(0,i.Z)(n,2),o=t[0],r=t[1];if(o&&o in y){var s=y[o],a=s.fuse,l=s.all,u=r?a.search(r).map((function(e){return"".concat(o,":").concat(e.item)})):l.map((function(e){return"".concat(o,":").concat(e)}));return u.map((function(e){return e.toLowerCase()})).includes(e)?[]:u}return m.search(e).map((function(e){return e.item}))}),[m,y]),w=function(e,n){var t=n.toLocaleLowerCase().trim().split(/\s+/),o=t[t.length-1]||"",r=v.useMemo((function(){return e(o)}),[e,o]),i=v.useCallback((function(e){var t=n.toLocaleLowerCase().lastIndexOf(o);if(-1!==t){var r=n.slice(0,t);return"".concat(r).concat(e)}return n}),[o,n]);return v.useMemo((function(){return{suggestions:r,onSelectSuggestion:i}}),[i,r])}(x,n),C=w.suggestions,b=w.onSelectSuggestion,L=C.length,Z=C[g]||null,I=v.useCallback((function(e){c({type:"change-query"}),t(e.target.value)}),[t]),R=v.useCallback((function(e){c({type:"select-suggestion"}),t(b(e))}),[t,b]),N=v.useCallback((function(){var e;c({type:"change-query"}),t(""),null===(e=f.current)||void 0===e||e.focus()}),[t]);return(0,S.jsx)(j.J,{isOpen:d&&C.length>0,position:"bottom-left",content:(0,S.jsx)(O,{children:C.map((function(e,n){return(0,S.jsx)(F,{suggestion:e,isHighlight:g===n,onSelect:R},e)}))}),children:(0,S.jsx)(U,{placeholder:"Filter\u2026",spellCheck:!1,autoCorrect:"off",value:n,ref:f,onChange:I,onFocus:function(){return c({type:"show-popover"})},onBlur:function(){return c({type:"hide-popover"})},onKeyDown:function(e){var n=e.key;if("Escape"!==n){if(L){var t=L-1;switch(n){case"ArrowUp":e.preventDefault(),c({type:"highlight",highlight:0===g?t:g-1});break;case"ArrowDown":e.preventDefault(),c({type:"highlight",highlight:g===t?0:g+1});break;case"Enter":e.preventDefault(),Z&&R(Z)}}}else c({type:"hide-popover"})},rightElement:(0,S.jsx)(k.C,{onClick:N,children:(0,S.jsx)(p.JO,{name:"cancel"})})})})},F=function(e){var n=e.suggestion,t=e.isHighlight,o=e.onSelect,r=v.useRef(null);return v.useEffect((function(){r.current&&t&&r.current.scrollIntoView({block:"nearest"})}),[t]),(0,S.jsx)(M,{ref:r,isHighlight:t,onMouseDown:function(e){e.preventDefault(),o(n)},children:n})},U=(0,s.ZP)(E.oi).withConfig({displayName:"LogsFilterInput__FilterInput",componentId:"sc-3dxor8-0"})(["width:300px;"]),O=s.ZP.ul.withConfig({displayName:"LogsFilterInput__Results",componentId:"sc-3dxor8-1"})(["list-style:none;margin:0;max-height:200px;max-width:800px;min-width:300px;overflow-y:auto;padding:4px 0;"]),M=s.ZP.li.withConfig({displayName:"LogsFilterInput__Item",componentId:"sc-3dxor8-2"})(["align-items:center;background-color:",";color:",";cursor:pointer;display:flex;flex-direction:row;font-size:12px;list-style:none;margin:0;padding:4px 8px;white-space:nowrap;text-overflow:ellipsis;&:hover{background-color:",";}"],(function(e){return e.isHighlight?h.w.Blue500:h.w.White}),(function(e){return e.isHighlight?h.w.White:"default"}),(function(e){return e.isHighlight?h.w.Blue500:h.w.Gray100})),A=t(13887),$=t(50466),q=function(e){return e.structured="structured",e.stdout="stdout",e.stderr="stderr",e}({}),V=function(e){var n=e.steps,t=e.metadata,o=e.counts,r=e.filter,s=e.onSetFilter,u=e.logType,c=e.onSetLogType,d=e.computeLogFileKey,p=e.onSetComputeLogKey,g=e.computeLogUrl,f=e.children,h=(0,w.U)("initial-compute-log-type",(function(e){return"string"===typeof e?e:q.stdout})),m=(0,i.Z)(h,2),y=m[0],C=m[1],b=v.useCallback((function(e){C(e),c(e)}),[c,C]),j=v.useMemo((function(){return new Set([u===q.structured?u:y])}),[u,y]);return(0,S.jsxs)(x.qn,{children:[(0,S.jsx)(a.x,{margin:{right:12},children:(0,S.jsx)(l.h,{activeItems:j,buttons:[{id:q.structured,icon:"list",tooltip:"Structured event logs"},{id:y,icon:"wysiwyg",tooltip:"Raw compute logs"}],onClick:function(e){return c(e)}})}),"structured"===u?(0,S.jsx)(W,{counts:o,filter:r,onSetFilter:s,showCopyURL:!f,steps:n}):(0,S.jsx)(H,{steps:n,metadata:t,logType:u,onSetLogType:b,computeLogFileKey:d,onSetComputeLogKey:p,computeLogUrl:g}),f]})},G=function(e,n){return n.stepKeys.some((function(n){return e.steps[n].state===C.TN.RUNNING}))?C.TN.RUNNING:n.stepKeys.some((function(n){return e.steps[n].state===C.TN.SKIPPED}))?C.TN.SKIPPED:n.stepKeys.every((function(n){return e.steps[n].state===C.TN.SUCCEEDED}))?C.TN.SUCCEEDED:C.TN.FAILED},H=function(e){var n=e.steps,t=e.metadata,o=e.computeLogFileKey,r=e.onSetComputeLogKey,i=e.logType,s=e.onSetLogType,m=e.computeLogUrl,v=t.logCaptureSteps||(0,C.co)(Object.keys(t.steps)),y=o&&v[o],x=!!y,w=function(e){if(!e||!v[e])return null;var n=v[e];return 1===n.stepKeys.length&&e===n.stepKeys[0]?e:n.pid&&1===n.stepKeys.length?n.stepKeys[0]:n.pid?"pid: ".concat(n.pid," (").concat(n.stepKeys.length," steps)"):"".concat(e," (").concat(n.stepKeys.length," steps)")};return(0,S.jsxs)(a.x,{flex:{justifyContent:"space-between",alignItems:"center",direction:"row"},style:{flex:1},children:[(0,S.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[n?(0,S.jsx)(u.P,{disabled:!n.length,items:Object.keys(v),itemPredicate:function(e,n){return n.toLocaleLowerCase().includes(e.toLocaleLowerCase())},itemRenderer:function(e,n){return(0,S.jsx)(c.sN,{onClick:n.handleClick,text:w(e),active:n.modifiers.active},e)},activeItem:o,onItemSelect:function(e){r(e)},children:(0,S.jsx)(d.zx,{disabled:!n.length,rightIcon:(0,S.jsx)(p.JO,{name:"expand_more"}),children:w(o)||"Select a step..."})}):void 0,x?(0,S.jsx)(l.h,{activeItems:new Set([i]),onClick:s,buttons:[{id:q.stdout,label:"stdout"},{id:q.stderr,label:"stderr"}]}):null,n?void 0:(0,S.jsxs)(a.x,{children:["Step: ",((null===y||void 0===y?void 0:y.stepKeys)||[]).join(", ")]})]}),x?(0,S.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[y?(0,S.jsx)(g.u,{placement:"top-end",content:"Status of this log capture group",children:G(t,y)===C.TN.RUNNING?(0,S.jsx)(f.$,{purpose:"body-text"}):(0,S.jsx)(b,{state:G(t,y)})}):null,m?(0,S.jsx)(g.u,{placement:"top-end",content:1===(null===y||void 0===y?void 0:y.stepKeys.length)?"Download ".concat(null===y||void 0===y?void 0:y.stepKeys[0]," compute logs"):"Download compute logs",children:(0,S.jsx)(J,{"aria-label":"Download link",href:m,download:!0,children:(0,S.jsx)(p.JO,{name:"download_for_offline",color:h.w.Gray600})})}):null]}):null]})},J=s.ZP.a.withConfig({displayName:"LogsToolbar__DownloadLink",componentId:"sc-d9cqde-0"})(["border-radius:4px;display:block;text-decoration:none;","{transition:background-color 100ms linear;}:hover ","{background-color:",";}:active ",",:focus ","{background-color:",";}:focus{outline:none;}"],p.a1,p.a1,h.w.Gray800,p.a1,p.a1,h.w.Dark),W=function(e){var n,t=e.filter,s=e.counts,l=e.onSetFilter,u=e.steps,c=e.showCopyURL,g=v.useState("assignment"),f=(0,i.Z)(g,2),h=f[0],m=f[1],C=t.logQuery.map((function(e){var n=e.token,t=e.value;return n?"".concat(n,":").concat(t):t})).join(" "),b=v.useState((function(){return C})),j=(0,i.Z)(b,2),L=j[0],I=j[1],R=(0,y.m)(),E=(0,w.U)($.mF,$.nF),T=(0,i.Z)(E,2),k=(T[0],T[1]),D=(null===(n=t.logQuery.find((function(e){return"step"===e.token})))||void 0===n?void 0:n.value)||null,K=t.logQuery.reduce((function(e,n){return e+n.value}),"");v.useEffect((function(){I(C)}),[C]);var _=v.useCallback((function(e,n){var i=new Set(Object.keys(t.levels).filter((function(e){return!!t.levels[e]})));n?i.add(e):i.delete(e),k(Array.from(i)),l((0,r.Z)((0,r.Z)({},t),{},{levels:(0,r.Z)((0,r.Z)({},t.levels),{},(0,o.Z)({},e,n))}))}),[t,l,k]);v.useEffect((function(){var e;return"assignment_turned_in"===h&&(e=setTimeout((function(){m("assignment")}),2e3)),function(){e&&clearTimeout(e)}}),[h]);var F=Object.fromEntries(Object.keys(N.i).map((function(e){return[e,{label:e.toLowerCase(),count:s[e],enabled:!!t.levels[e]}]})));return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(P,{value:L,suggestionProviders:(0,A.m)(u),onChange:function(e){var n=e.split(/\s+/).map((function(e){var n=e.split(":");return n.length>1?{token:n[0],value:n[1]}:{value:n[0]}}));l((0,r.Z)((0,r.Z)({},t),{},{logQuery:n})),I(e)}}),K?(0,S.jsx)(Q,{checked:t.hideNonMatches,onChange:function(e){return l((0,r.Z)((0,r.Z)({},t),{},{hideNonMatches:e.currentTarget.checked}))},label:"Hide non-matches"}):null,(0,S.jsx)(a.x,{flex:{direction:"row",alignItems:"center",gap:8},margin:{left:12},children:(0,S.jsx)(Z,{options:F,onSetFilter:_})}),D&&(0,S.jsx)(x.KC,{}),(0,S.jsx)("div",{style:{minWidth:15,flex:1}}),c&&(0,S.jsx)(d.zx,{icon:(0,S.jsx)(p.JO,{name:h}),onClick:function(){R(window.location.href),m("assignment_turned_in")},children:"Copy URL"})]})},Q=(0,s.ZP)(m.X).withConfig({displayName:"LogsToolbar__NonMatchCheckbox",componentId:"sc-d9cqde-1"})(["&&&{margin:0 4px 0 12px;}white-space:nowrap;"])},17471:function(e,n,t){t.d(n,{o:function(){return w}});var o,r=t(71171),i=t(9249),s=t(87371),a=t(45754),l=t(86906),u=t(96234),c=t(60319),d=t(4537),p=t(61623),g=t(32667),f=t(62459),h=t(57103),m=t(24748),v=t.n(m),y=t(78193),x=t(35936),w=y.memo((function(e){var n=e.logData,t=e.location,o=e.isLoading,r=e.isVisible,i=e.downloadUrl,s=y.useRef(null),a=y.useRef(),l=y.useState(!1),c=(0,u.Z)(l,2),h=c[0],m=c[1],v=function(){a.current&&(clearTimeout(a.current),a.current=0)},w=function(){m(!1),v()},b=function(){a.current=window.setTimeout(w,3e3)},j=n,L=C(j);if(j&&L){var S=j.indexOf("\n")+1,Z=S<j.length?j.slice(S):j;j="\x1b[33m...logs truncated...\x1b[39m\n"+Z}var I=L?(0,x.jsx)(P,{children:(0,x.jsxs)(d.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,x.jsx)(p.JO,{name:"warning",color:g.w.Yellow500}),(0,x.jsxs)("div",{children:["This log has exceeded the 5MB limit."," ",i?(0,x.jsx)("a",{href:i,download:!0,children:"Download the full log file"}):null,"."]})]})}):null;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(R,{isVisible:r,children:[h?(0,x.jsx)(K,{children:(0,x.jsx)(_,{onClick:function(){s.current&&s.current.scrollToTop()},onMouseOver:v,onMouseOut:b,children:(0,x.jsxs)(d.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,x.jsx)(p.JO,{name:"arrow_upward",color:g.w.White}),"Scroll to top"]})})}):null,(0,x.jsxs)(E,{children:[I,(0,x.jsx)(T,{children:(0,x.jsx)(k,{isSelected:!0,content:n,onScrollUp:function(e){v(),e?(m(!0),b()):w()},onScrollDown:w,ref:s})})]}),o?(0,x.jsx)(D,{children:(0,x.jsx)(f.$,{purpose:"page"})}):null]}),t?(0,x.jsx)(N,{isVisible:r,children:t}):null]})})),C=function(e){return!!e&&(new TextEncoder).encode(e).length>=5242880},b=function(e){(0,a.Z)(t,e);var n=(0,l.Z)(t);function t(){var e;(0,i.Z)(this,t);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return(e=n.call.apply(n,[this].concat(r))).container=y.createRef(),e.lastScroll=0,e.onScroll=function(){if(e.container.current&&e.props.isSelected){var n=e.props,t=n.onScrollUp,o=n.onScrollDown,r=e.container.current,i=r.scrollHeight,s=r.scrollTop/(i-r.offsetHeight);e.container.current.scrollTop<e.lastScroll?t&&t(s):o&&o(s),e.lastScroll=e.container.current.scrollTop}},e}return(0,s.Z)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom(),this.container.current&&(this.container.current.focus(),this.container.current.addEventListener("scroll",this.onScroll))}},{key:"getSnapshotBeforeUpdate",value:function(){if(!this.container.current)return!1;var e=this.container.current,n=e.scrollHeight,t=e.scrollTop;return e.offsetHeight+t>=n}},{key:"componentDidUpdate",value:function(e,n,t){t&&this.scrollToBottom(),this.props.isSelected&&!e.isSelected&&this.container.current&&this.container.current.focus()}},{key:"focus",value:function(){var e=this.container.current;e&&e.focus()}},{key:"scrollToBottom",value:function(){var e=this.container.current;e&&(e.scrollTop=e.scrollHeight-e.offsetHeight)}},{key:"scrollToTop",value:function(){var e=this.container.current;e&&(e.scrollTop=0,e.focus())}},{key:"render",value:function(){var e=this.props,n=e.content,t=e.className;return n?(0,x.jsx)("div",{className:t,style:{outline:"none"},ref:this.container,tabIndex:0,children:(0,x.jsxs)(I,{children:[(0,x.jsx)(j,{content:n}),(0,x.jsxs)(L,{children:[(0,x.jsx)(Z,{}),(0,x.jsx)(v(),{linkify:!1,useClasses:!0,children:n})]})]})}):(0,x.jsx)("div",{className:t,ref:this.container,children:(0,x.jsx)(I,{style:{justifyContent:"center",alignItems:"center"},children:null==n?"No log file available":"No output"})})}}]),t}(y.Component),j=function(e){var n=e.content;if(!n)return null;var t=n.match(/\n/g),o=t?t.length:0;return(0,x.jsx)(S,{children:Array.from(Array(o),(function(e,n){return(0,x.jsx)("div",{children:String(n+1)},n)}))})},L=c.ZP.div.withConfig({displayName:"RawLogContent__Content",componentId:"sc-175qttj-0"})(["padding:10px;background-color:",";"],g.w.Gray900),S=c.ZP.div.withConfig({displayName:"RawLogContent__LineNumberContainer",componentId:"sc-175qttj-1"})(["display:flex;flex-direction:column;align-items:flex-end;border-right:1px solid #5c7080;padding:10px 10px 10px 20px;margin-right:5px;background-color:",";opacity:0.8;color:#858585;min-height:100%;"],g.w.Gray900),Z=(0,c.vJ)(o||(o=(0,r.Z)(["\n  .ansi-black {\n    color: #586e75;\n  }\n  .ansi-red {\n    color: #dc322f;\n  }\n  .ansi-green {\n    color: #859900;\n  }\n  .ansi-yellow {\n    color: #b58900;\n  }\n  .ansi-blue {\n    color: #268bd2;\n  }\n  .ansi-magenta {\n    color: #d33682;\n  }\n  .ansi-cyan {\n    color: #2aa198;\n  }\n  .ansi-white {\n    color: #eee8d5;\n  }\n"]))),I=c.ZP.div.withConfig({displayName:"RawLogContent__ContentContainer",componentId:"sc-175qttj-2"})(["display:flex;flex-direction:row;min-height:100%;background-color:",";"],g.w.Gray900),R=c.ZP.div.withConfig({displayName:"RawLogContent__FileContainer",componentId:"sc-175qttj-3"})(["flex:1;height:100%;position:relative;&:first-child{border-right:0.5px solid #5c7080;}display:flex;flex-direction:column;",""],(function(e){return e.isVisible?null:"display: none;"})),N=c.ZP.div.withConfig({displayName:"RawLogContent__FileFooter",componentId:"sc-175qttj-4"})(["display:flex;flex-direction:row;align-items:center;height:30px;background-color:",";border-top:0.5px solid #5c7080;color:#aaaaaa;padding:2px 5px;font-size:0.85em;",""],g.w.Gray900,(function(e){return e.isVisible?null:"display: none;"})),E=c.ZP.div.withConfig({displayName:"RawLogContent__FileContent",componentId:"sc-175qttj-5"})(["flex:1;display:flex;flex-direction:column;"]),T=c.ZP.div.withConfig({displayName:"RawLogContent__RelativeContainer",componentId:"sc-175qttj-6"})(["flex:1;position:relative;"]),k=(0,c.ZP)(b).withConfig({displayName:"RawLogContent__LogContent",componentId:"sc-175qttj-7"})(["color:#eeeeee;font-family:",";font-size:16px;white-space:pre;overflow:auto;position:absolute;top:0;bottom:0;left:0;right:0;"],h.b.monospace),D=c.ZP.div.withConfig({displayName:"RawLogContent__LoadingContainer",componentId:"sc-175qttj-8"})(["display:flex;justifycontent:center;alignitems:center;position:absolute;top:0;bottom:0;left:0;right:0;backgroundcolor:",";opacity:0.3;"],g.w.Gray800),K=c.ZP.div.withConfig({displayName:"RawLogContent__ScrollToast",componentId:"sc-175qttj-9"})(["position:absolute;height:30px;top:0;left:0;right:0;display:flex;flex-direction:row;justify-content:center;align-items:flex-start;z-index:1;"]),_=c.ZP.div.withConfig({displayName:"RawLogContent__ScrollToTop",componentId:"sc-175qttj-10"})(["background-color:black;padding:10px 20px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;color:white;border-bottom:0.5px solid #5c7080;border-left:0.5px solid #5c7080;border-right:0.5px solid #5c7080;cursor:pointer;"]),P=c.ZP.div.withConfig({displayName:"RawLogContent__FileWarning",componentId:"sc-175qttj-11"})(["background-color:#fffae3;padding:10px 20px;margin:20px 70px;border-radius:5px;"])},41084:function(e,n,t){t.d(n,{c:function(){return s},r:function(){return a}});var o=t(96234),r=t(78193),i=t(46860),s=function(e,n){var t=(e?Object.values(e):[]).find((function(e){return e.stepKeys.includes(n)}));return t&&(null===t||void 0===t?void 0:t.fileKey)};function a(e){var n=e.stepKeys,t=e.selectionStepKeys,a=e.metadata,l=(0,i.q)({queryKey:"logFileKey"}),u=(0,o.Z)(l,2),c=u[0],d=u[1];return r.useEffect((function(){if(null!==n&&void 0!==n&&n.length&&!c)if(a.logCaptureSteps){var e=Object.keys(a.logCaptureSteps),o=e.find((function(e){return t.every((function(n){return a.logCaptureSteps&&a.logCaptureSteps[e].stepKeys.includes(n)}))}));d(o||e[0])}else if(n.includes(c)){if(1===t.length&&c!==t[0]){var r=s(a.logCaptureSteps,t[0]);r&&d(r)}}else{var i=s(a.logCaptureSteps,1===t.length?t[0]:n[0]);i&&d(i)}}),[n,c,t,a.logCaptureSteps,d]),{logCaptureInfo:a.logCaptureSteps&&c in a.logCaptureSteps?a.logCaptureSteps[c]:void 0,computeLogFileKey:c,setComputeLogFileKey:d}}},50466:function(e,n,t){t.d(n,{Bz:function(){return x},mF:function(){return v},nF:function(){return y}});var o=t(96234),r=t(56666),i=t(33028),s=t(29845),a=t(78193),l=t(46860),u=t(79962),c=t(15998),d=t(13887),p="|";function g(e){return e.sort().map((function(e){return e.toLowerCase()})).join(p)}var f={steps:"*",logs:"",levels:g(c.w),hideNonMatches:"true",focusedTime:""},h=function(e){var n=e.logs||"",t=e.focusedTime||"",o=e.hideNonMatches||"",a=e.levels||"",l=n.split(p),u=t&&!n?Number(t):null,g="true"===o,f=(0,d.m)();return{sinceTime:0,focusedTime:u,hideNonMatches:g,logQuery:l.map((function(e){return(0,s.WD)(e,f)})),levels:a.split(p).map((function(e){return e.toUpperCase()})).filter((function(e){return c.i.hasOwnProperty(e)})).reduce((function(e,n){return(0,i.Z)((0,i.Z)({},e),{},(0,r.Z)({},n,!0))}),{})}};function m(e){var n=e.logQuery.map((function(e){return e.token?"".concat(e.token,":").concat(e.value):e.value}));return{hideNonMatches:e.hideNonMatches?"true":"false",focusedTime:e.focusedTime||"",logs:n.join(p),levels:g(Object.keys(e.levels).filter((function(n){return!!e.levels[n]})))}}var v="EnabledRunLogLevels",y=function(e){if(void 0===e||!Array.isArray(e))return null;var n=new Set(Object.keys(c.i));return e.filter((function(e){return n.has(e)}))};function x(){var e=(0,u.U)(v,y),n=(0,o.Z)(e,1)[0],t=a.useMemo((function(){var e=null!==n&&void 0!==n?n:c.w;return(0,i.Z)((0,i.Z)({},f),{},{levels:g(e)})}),[n]);return(0,l.q)({encode:m,decode:h,defaults:t})}}}]);
//# sourceMappingURL=874.762ddbe4.chunk.js.map